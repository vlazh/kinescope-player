(self.webpackChunk=self.webpackChunk||[]).push([[523],{8271:function(e,t,i){"use strict";function a(e){return 0===e.length?{}:e.toSorted(((e,t)=>e.lang&&t.lang?e.lang.localeCompare(t.lang):0)).reduce(((e,t,i)=>{var{lang:a,name:r,url:s,default:n}=t;return a?(e[a]={index:i,language:a,name:r,url:s,default:n},e):e}),{})}i.d(t,{X:function(){return a}})},13915:function(e,t,i){"use strict";i.d(t,{L:function(){return r}});var a=i(31729);function r(e){return 0===e.length?{}:e.reduce(((e,t,i)=>{var r=(0,a.j)(t);return null!=r&&(e[r]={level:i,url:Array.isArray(t.url)?t.url[0]:t.url}),e}),{})}},27681:function(e,t,i){"use strict";i.d(t,{e:function(){return s}});var a=i(80181),r=i(67106);function s(e,t){var i=Math.max("number"==typeof e&&e||"object"==typeof e&&e.checkInterval||6e4,1e3),[s,n]=a.c$.of("object"==typeof e&&e.limit||void 0).map((e=>{var{time:t,checkInterval:i}=e;return[t>0&&t||void 0,i]})).getOrElse([void 0,void 0]),l=s?(0,r.s)({interval:()=>1e3,callback:e=>{if(Date.now()>=s){if(e.stop(),!o.isActive())return;n?(i=n,o.start({immediately:!0})):(o.stop(),t())}},autostart:!1}):void 0,o=(0,r.s)({interval:()=>i,callback:()=>t(),onStop:l&&(()=>l.stop()),autostart:!1});return o.start(),null!=l&&l.start(),o}},38105:function(e,t,i){"use strict";i.d(t,{n:function(){return _}});var a=i(55823),r=i(58245),s=i(33612),n=i(70866),l=i(85186),o=i(9374),d=i(61542),u=i(86275),h=i(35018),c=i(82128),v=i(45006),g=i(37998),m=i(2593),p=i(18168);function y(e){switch(e){case MediaError.MEDIA_ERR_NETWORK:return"network";case MediaError.MEDIA_ERR_DECODE:case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:return"media";default:return"generic"}}var f=i(86503),E=i(18430),S=i(47390),T=i(67106);function D(e,t,i,a,r,s,n){try{var l=e[s](n),o=l.value}catch(e){return void i(e)}l.done?t(o):Promise.resolve(o).then(a,r)}function b(e,t){var i,a,{url:r,interval:s=6e4,responseHandler:n=e=>Promise.resolve(200===e.status)}=e;return(0,T.s)({interval:()=>s,callback:(i=function*(){var e=yield fetch(r);(yield n(e))&&t()},a=function(){var e=this,t=arguments;return new Promise((function(a,r){var s=i.apply(e,t);function n(e){D(s,a,r,n,l,"next",e)}function l(e){D(s,a,r,n,l,"throw",e)}n(void 0)}))},function(){return a.apply(this,arguments)}),waitCallback:!0,autostart:!1})}var w=i(4556),L=i(90668);function A(){return A=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)({}).hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},A.apply(null,arguments)}class k extends r.b{constructor(e,t){void 0===t&&(t={}),super(),this.stalled=!1,this.startStalledTime=0,this.cancel=()=>{this.setStalled(!1),this.resetStallDetected()},this.progressHandler=()=>{var e=this.listener.target;this.stalledBuffer&&this.stalledBuffer.start===(0,c.BC)(e.buffered)&&this.stalledBuffer.end===(0,c.Q5)(e.buffered)||this.cancel()},this.timeupdateHandler=()=>{var e=this.listener.target;e.paused&&!e.seeking&&this.setStalledDelayed.isPending?this.resetStallDetected():this.setStalledDelayed.isPending?this.stallDetected():this.listener.off("timeupdate",this.timeupdateHandler)},this.poll=()=>{var e=this.listener.target;!this.isStalled()&&e.buffered.length>0&&(e.seeking||e.readyState<=e.HAVE_CURRENT_DATA&&e.networkState===e.NETWORK_LOADING)&&this.stallDetected()},this.options=A({},t,{delay:t.delay||5e3}),this.setStalledDelayed=(0,w.s)((()=>this.setStalled(!0)),this.options.delay),this.listener=(e instanceof HTMLMediaElement?new L.H(e):e).on("waiting",this.poll).on("seeking",this.poll)}stallDetected(){var e=this.listener.target;this.stalledBuffer={start:(0,c.BC)(e.buffered),end:(0,c.Q5)(e.buffered)},this.startStalledTime=Date.now(),this.setStalledDelayed(),this.listener.on("progress",this.progressHandler).on("timeupdate",this.timeupdateHandler).on("emptied",this.cancel)}resetStallDetected(){this.stalledBuffer=void 0,this.startStalledTime=0,this.listener.off("progress",this.progressHandler),this.listener.off("timeupdate",this.timeupdateHandler),this.listener.off("emptied",this.cancel),this.setStalledDelayed.cancel()}isStalled(){return this.stalled}setStalled(e){if(this.stalled!==e)if(this.stalled=e,this.stalled)this.emit("statechanged",{stalled:this.stalled,duration:0});else{var t=Math.max(Date.now()-this.startStalledTime,0);this.emit("statechanged",{stalled:this.stalled,duration:t})}}destroy(){this.resetStallDetected(),this.listener.off("waiting",this.poll),this.listener.off("seeking",this.poll),this.stalled=!1,this.emit("destroy"),this.removeAllListeners()}[Symbol.dispose](){return this.destroy()}}var R,I=i(54548);function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)({}).hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},C.apply(null,arguments)}class P extends r.b{constructor(e,t){var i,a;void 0===t&&(t={}),super(),this.waiting=!1,this.lastTime=-1,this.startWaitingTime=0,this.startWaiting=()=>{this.waiting||this.setWaitingDelayed.isPending||(this.lastTime=this.listener.target.currentTime,this.startWaitingTime=Date.now(),this.setWaitingDelayed(),this.listener.on("timeupdate",this.timeupdateHandler))},this.stopWaiting=()=>{this.setWaitingDelayed.cancel(),this.waiting&&(this.setWaiting(!1),this.listener.off("timeupdate",this.timeupdateHandler))},this.timeupdateHandler=()=>{var e=this.listener.target;e.paused?e.seeking&&!this.options.stopOnPauseIfSeeking||this.stopWaiting():this.lastTime!==e.currentTime&&this.stopWaiting()},this.options=C({},t,{delay:null!=(i=t.delay)?i:500,stopOnPauseIfSeeking:null!=(a=t.stopOnPauseIfSeeking)&&a}),this.setWaitingDelayed=(0,I.G)((0,w.s)((()=>this.setWaiting(!0)),this.options.delay),(()=>{this.lastTime=this.listener.target.currentTime,this.startWaitingTime=Date.now()})),this.listener=e instanceof HTMLMediaElement?new L.H(e):e,this.listener.on("waiting",this.startWaiting),this.listener.on("seeking",this.startWaiting)}setWaiting(e){if(this.waiting!==e)if(this.waiting=e,this.waiting)this.emit("statechanged",{waiting:!0,duration:0});else{var t=Math.max(Date.now()-this.startWaitingTime,0);this.lastTime=-1,this.startWaitingTime=0,this.emit("statechanged",{waiting:!1,duration:t})}}isWaiting(){return this.waiting}destroy(){this.listener.off("timeupdate",this.timeupdateHandler),this.listener.off("waiting",this.startWaiting),this.listener.off("seeking",this.startWaiting),this.waiting=!1,this.lastTime=-1,this.startWaitingTime=0,this.emit("destroy"),this.removeAllListeners()}[Symbol.dispose](){return this.destroy()}}function O(){return O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)({}).hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},O.apply(null,arguments)}function N(e,t,i,a,r,s,n){try{var l=e[s](n),o=l.value}catch(e){return void i(e)}l.done?t(o):Promise.resolve(o).then(a,r)}function M(e){return function(){var t=this,i=arguments;return new Promise((function(a,r){var s=e.apply(t,i);function n(e){N(s,a,r,n,l,"next",e)}function l(e){N(s,a,r,n,l,"throw",e)}n(void 0)}))}}class _ extends r.b{get Events(){return _.Events}constructor(e,t,i){super(),this.format=e,this.eventListeners=new u.g,this.cleaners=[],this.loaded=!1,this.live=!1,this.played=!1,this.actuallyPlayed=!1,this.seeked=!1,this.sourceChanging=!1,this.suspended=!1,this.reloadMediaOnReplay=!1,this.networkStateController={isOnline:()=>!0},this.name=t||this.constructor.name,this.logger=null!=i?i:(0,m.t)(this.name);var a=(0,d.d)(5);this.attachMutex=new s.e(this.name+"."+a+".",this.logger),this.detachMutex=new s.e(this.name+"."+a+".",this.logger),this.destroyMutex=new s.e(this.name+"."+a+".",this.logger),this.on(this.Events.Loaded,(()=>{this.loaded=!0,this.emit(this.Events.LiveStateChanged,this.getLiveState())}))}get networkState(){return this.networkStateController}getMediaElement(){if(!this.media)throw new g.i;return this.media}initMedia(e){this.media=e;var t=this.eventListeners.scope(this.media,"@_init");t.has("play")||this.played||t.once("play",(()=>{this.played=!0})),t.has("playing")||this.actuallyPlayed||t.once("playing",(()=>{this.actuallyPlayed=!0})),t.has("seeked")||this.seeked||t.once("seeked",(()=>{this.seeked=!0})),t.has("loadstart")||t.on("loadstart",(()=>{e.loading=!0;var i=()=>{t.off("loadeddata",i),t.off("emptied",i),t.off("error",i),delete e.loading};t.once("loadeddata",i),t.once("emptied",i),t.once("error",i),this.isLoaded()||this.isSourceChanging()||e.reloading||this.emit(this.Events.LoadStart)})),t.has("emptied")||t.on("emptied",(()=>{!this.isLoaded()||this.isSourceChanging()||e.reloading||this.detach().catch((e=>this.handleError(e,{severity:"warning",path:"detach"})))}))}attach(e,t,i){var r=this;return M((function*(){var s={stack:[],error:void 0,hasError:!1};try{(0,a.__addDisposableResource)(s,yield r.attachMutex.acquire("attach"),!1),r.media&&(yield r.detach());try{var n,l,o=null!=(n="function"==typeof(null==i?void 0:i.mediaWaitingDetection)?i.mediaWaitingDetection(r):null==i?void 0:i.mediaWaitingDetection)?n:{},d=null!=(l="function"==typeof(null==i?void 0:i.mediaStallDetection)?i.mediaStallDetection(r):null==i?void 0:i.mediaStallDetection)?l:"native"===r.playback;if(r.attachSources=t,r.attachOptions=O({},i,{mediaWaitingDetection:o,mediaStallDetection:d}),r.initMedia(e),r.waitingDetector=new P(r.eventListeners.scope(e,"@_WaitingDetector"),o).on("statechanged",(e=>{var{data:t}=e;r.emit(r.Events.WaitingStateChanged,t)})),d){var u=!0===d?void 0:d;r.stallDetector=new k(r.eventListeners.scope(e,"@_StallDetector"),u).on("statechanged",(e=>{var{data:t}=e;r.emit(r.Events.ProgressStateChanged,O({fatal:!1},t))}))}yield r.attachCore(e,r.attachSources,r.attachOptions)}catch(e){r.handleError(e,{path:"attach"})}}catch(e){s.error=e,s.hasError=!0}finally{(0,a.__disposeResources)(s)}}))()}detach(){var e=this;return M((function*(){var t={stack:[],error:void 0,hasError:!1};try{var i;(0,a.__addDisposableResource)(t,yield e.detachMutex.acquire("detach"),!1);var r=!!e.media;yield e.detachCore(),e.cleaners.forEach((e=>e())),(0,n.I)(e.cleaners),e.eventListeners.removeAllListeners(),e.waitingDetector&&(e.waitingDetector.destroy(),e.waitingDetector=void 0),e.stallDetector&&(e.stallDetector.destroy(),e.stallDetector=void 0),e.media&&((0,v.a)(e.media),e.media=void 0),e.attachSources=void 0,e.attachOptions=void 0,e.loaded=!1,e.live=!1,e.played=!1,e.actuallyPlayed=!1,e.seeked=!1,e.sourceChanging=!1,e.suspended=!1,null!=(i=e.liveChecker)&&i.stop(),e.liveChecker=void 0,r&&e.emit(e.Events.Detached)}catch(r){t.error=r,t.hasError=!0}finally{(0,a.__disposeResources)(t)}}))()}stopLoad(){}startLoad(){}isLoaded(){return this.loaded}isPlayed(){return this.played}isActuallyPlayed(){return this.actuallyPlayed}isSeeked(){return this.seeked}isWaiting(){var e;return!(null==(e=this.waitingDetector)||!e.isWaiting())}isStalled(){var e;return!(null==(e=this.stallDetector)||!e.isStalled())}isSourceChanging(){return this.sourceChanging}isPlaybackFreezed(){var e;return 0===(null==(e=this.media)?void 0:e.playbackRate)}isLive(){return this.live}isSuspended(){return this.suspended}suspend(){var e=this.getMediaElement();e.pause(),this.suspended=!0;var t=()=>this.releaseSuspended();this.eventListeners.scope(e,"@_suspend").removeAllListeners().once("play",t).once("ended",t).once("emptied",t)}releaseSuspended(){var e=this.getMediaElement();this.suspended=!1,this.eventListeners.removeAllListeners(e,"@_suspend")}seek(e){return(0,p.h)(this.getMediaElement(),e)}getCurrentTime(){var e,t;return null!=(e=null==(t=this.media)?void 0:t.currentTime)?e:0}getDuration(){return this.media?(0,h.A)(this.media)||(0,c.Q5)(this.media.seekable)||1/0:NaN}getSeekRange(){return this.media?{start:(0,c.BC)(this.media.seekable),end:(0,c.Q5)(this.media.seekable)}:{start:0,end:0}}setSourceChanging(e){this.sourceChanging!==e&&(this.sourceChanging=e,e?this.emit(this.Events.SourceChanging):this.emit(this.Events.SourceChanged))}setLive(e){var t,i=this.live;if(this.live=e,i&&!this.live&&null!=(t=this.attachOptions)&&null!=(t=t.liveRevivalCheck)&&t.url&&!this.liveChecker){var a=b(this.attachOptions.liveRevivalCheck,(()=>{a.stop(),this.media&&this.attachSources&&this.attach(this.media,this.attachSources,this.attachOptions).catch((e=>{this.handleError(e,{path:"liveChecker:attach"})}))}));this.liveChecker=a,this.liveChecker.start(),this.emit(this.Events.LiveStateChanged,this.getLiveState())}else!i&&this.live&&this.liveChecker&&(this.liveChecker.stop(),this.liveChecker=void 0,this.emit(this.Events.LiveStateChanged,this.getLiveState()))}getLiveLatency(){return 0}getLiveSeekLength(){if(!this.media||!this.live)return 0;var e=this.getSeekRange(),t=e.end-e.start;return t>0?t:0}getLiveEdgePosition(){if(!this.media||!this.live)return 0;var e=this.getSeekRange().end,t=this.getLiveLatency();return e>t?e-t:e}atLiveEdge(e,t){return void 0===e&&(e=this.getCurrentTime()),void 0===t&&(t=this.getLiveEdgePosition()),!(!this.live||!this.media||null==e)&&Math.ceil(e)>=Math.floor(t-4)}getLiveState(){var e=this.getLiveEdgePosition();return{live:this.isLive(),synced:this.atLiveEdge(this.getCurrentTime(),e),latency:this.getLiveLatency(),seekLength:this.getLiveSeekLength(),edgePosition:e}}getStateInfo(){var e=this.getDebugData();return O({name:this.name,format:this.format,playback:this.playback,loaded:this.isLoaded(),played:this.isPlayed(),actuallyPlayed:this.isActuallyPlayed(),seeked:this.isSeeked(),currentTime:this.getCurrentTime(),duration:this.getDuration(),waiting:this.isWaiting(),stalled:this.isStalled(),playbackFreezed:this.isPlaybackFreezed(),videoQuality:this.getVideoQuality(),audioTrack:this.getAudioTrack(),liveState:this.getLiveState()},e&&{debugData:e})}getDebugData(){}getStats(){var e,t,{droppedVideoFrames:i=0,totalVideoFrames:a=0}=null!=(e=null==(t=this.media)?void 0:t.getVideoPlaybackQuality())?e:{};return{videoQuality:this.getVideoQuality(),droppedVideoFrames:i,totalVideoFrames:a,estimatedBandwidth:0}}handleError(e,t){var i,a,r,s=e instanceof ErrorEvent&&e.error||e instanceof Event&&(null==(i=this.media)?void 0:i.error)||e,[n,d]=(null==t?void 0:t.type)&&[t.type,s]||s instanceof f.l&&["media",s]||s instanceof E._&&["drm",s]||s instanceof S.S&&["manifest",s]||s instanceof MediaError&&[y(s.code),(s.code===MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED||s.code===MediaError.MEDIA_ERR_DECODE)&&new f.l((0,o.u)(s),{cause:{code:s.code,codeName:(0,l.np)(MediaError,s.code)}})||s]||["generic",s];this.emit(this.Events.Error,O({},t,{severity:null!=(a=null==t?void 0:t.severity)?a:"fatal",path:null!=(r=null==t?void 0:t.path)?r:"handleError",type:n,error:d,state:this.getStateInfo()}))}destroy(){var e=this;return M((function*(){var t={stack:[],error:void 0,hasError:!1};try{(0,a.__addDisposableResource)(t,yield e.destroyMutex.acquire("destroy"),!1),yield e.detach(),yield e.destroyCore(),e.removeAllListeners()}catch(i){t.error=i,t.hasError=!0}finally{(0,a.__disposeResources)(t)}}))()}[Symbol.asyncDispose](){return this.destroy()}}(function(e){e.LoadStart="LoadStart",e.MetadataChanged="MetadataChanged",e.Loaded="Loaded",e.Detached="Detached",e.SourceWaiting="SourceWaiting",e.SourceChanging="SourceChanging",e.SourceChanged="SourceChanged",e.QualityChanged="QualityChanged",e.AudioTrackChanged="AudioTrackChanged",e.LiveStateChanged="LiveStateChanged",e.NetworkStateChanged="NetworkStateChanged",e.WaitingStateChanged="WaitingStateChanged",e.ProgressStateChanged="ProgressStateChanged",e.Error="Error"})((R=_||(_={})).Events||(R.Events={}))},41746:function(e,t,i){"use strict";i.d(t,{u:function(){return r}});var a=i(80181);function r(e,t){return"string"==typeof e?a.c$.of(new URL(e,document.location.href)).map((e=>(t.forEach(((t,i)=>e.searchParams.set(i,t))),e.toString()))).getOrElse(e):Object.entries(e).reduce(((e,i)=>{var[a,s]=i;return e[a]="string"==typeof s?r(s,t):s,e}),{})}},45006:function(e,t,i){"use strict";function a(e){(e.src||e.srcObject||e.childElementCount>0)&&(URL.revokeObjectURL(e.src),e.removeAttribute("src"),e.srcObject=null,e.childElementCount>0&&Array.prototype.filter.call(e.children,(e=>e instanceof HTMLSourceElement)).forEach((t=>e.removeChild(t))),e.load())}i.d(t,{a:function(){return a}})},67700:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return ge}});var a=i(64917),r=i(52648),s=i(45591),n=i(82128),l=i(96157),o=i(46338),d=i(41746),u=i(31729),h=i(77687),c=i(15779),v=i(88913),g=i(38105),m=i(27681),p=i(44022),y=i(9374),f=i(72267),E=i(92529),S=i(18430),T=i(2593),D=i(18986),b=i(37696),w=["logger","keySystem","contentType"];function L(){return L=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)({}).hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},L.apply(null,arguments)}function A(e,t,i,a,r,s,n){try{var l=e[s](n),o=l.value}catch(e){return void i(e)}l.done?t(o):Promise.resolve(o).then(a,r)}function k(e){return function(){var t=this,i=arguments;return new Promise((function(a,r){var s=e.apply(t,i);function n(e){A(s,a,r,n,l,"next",e)}function l(e){A(s,a,r,n,l,"throw",e)}n(void 0)}))}}var R=function(){var e=k((function*(e,t){if(t)return"function"==typeof t?t(e):t;var i=(0,b.m)(new Uint16Array(e.buffer)),a=i.split(";",2);if(a.length>1)return a[1];var r=i.indexOf("://");return r>0?i.substring(r+3):""}));return function(t,i){return e.apply(this,arguments)}}();function I(e){var{mediaKeys:t,certificate:i,license:a,contentId:r,logger:s}=e;return function(){var e=k((function*(e){var{type:n,target:l,initData:o}=e;try{if(s.debug("WebKit EME:",n),!o)throw new S._(S._.Code.CDM,"InitData is null");var d=new Uint8Array(i),u=yield R(o,r),h=l;if(h.webkitSetMediaKeys(t),!h.webkitKeys)throw new S._(S._.Code.CDM,"WebKitMediaKeys has not created.");var c=t.createSession("video/mp4",(e=>{var{initData:t,contentId:i,cert:a}=e,r="string"==typeof i?(0,b.l)(i):i,s=0,n=new ArrayBuffer(t.byteLength+4+r.byteLength+4+a.byteLength),l=new DataView(n);new Uint8Array(n,s,t.byteLength).set(t),s+=t.byteLength,l.setUint32(s,r.byteLength,!0),s+=4;var o=new Uint16Array(n,s,r.length);return o.set(r),s+=o.byteLength,l.setUint32(s,a.byteLength,!0),s+=4,new Uint8Array(n,s,a.byteLength).set(a),new Uint8Array(n,0,n.byteLength)})({initData:o,contentId:u,cert:d}));if(!c)throw new S._(S._.Code.CDM,"WebKitMediaKeySession has not created.");c.contentId=u;var v=(0,p.s)({lazy:!0});c.addEventListener("webkitkeymessage",(e=>{s.debug("WebKit EME:",e.type),a({message:e.message}).then((e=>(s.debug("WebKit EME:","update license"),c.update(e)))).catch(v.reject)})),s.isLevelEnabled("debug")&&c.addEventListener("webkitkeyadded",(()=>{s.debug("WebKit EME KeySession:","key added"),v.resolve()})),c.addEventListener("webkitkeyerror",(()=>{var{error:e}=c,t=new S._(S._.Code.CDM,"WebKit EME KeySession Error: code "+e.code+", systemCode "+e.systemCode);v.pending?v.reject(t):s.error(t)})),yield v.wait()}catch(t){s.error(t instanceof S._?t:new S._(S._.Code.Other,(0,y.u)(t,{simple:!0}),{cause:t}))}}));return function(t){return e.apply(this,arguments)}}()}class C{constructor(e,t){var i;if(this.media=e,!t.certificate||!t.license)throw new S._(S._.Code.IncorrectDrmConfig,"Certifacate or license is not provided");if(!(0,E.Q)()&&"undefined"==typeof WebKitMediaKeys)throw new S._(S._.Code.Unsupported,"EME API is not available.");var a=null!=(i=t.logger)?i:(0,T.t)("EmeController");this.options=L({},t,{logger:a})}init(){var e=this;return k((function*(){D.p.install();var t=e.options,{logger:i,keySystem:a,contentType:r}=t,s=function(e,t){if(null==e)return{};var i={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;i[a]=e[a]}return i}(t,w),n=yield(e=>(0,f.F)((()=>"function"==typeof e?e():e)))(e.options.certificate);if(window.WebKitMediaKeys){if(i.debug("EmeController: Use Webkit-prefixed EME"),!WebKitMediaKeys.isTypeSupported(e.options.keySystem,r))throw new S._(S._.Code.Unsupported,"Key System '"+e.options.keySystem+"' is not supported.");var l=I(L({},s,{logger:i,mediaKeys:new WebKitMediaKeys(a),certificate:n}));e.initEventHandler=function(){l(...arguments),e.media.encrypted=!0},e.media.addEventListener("webkitneedkey",e.initEventHandler)}else{i.debug("EmeController: Use EME");var o=yield navigator.requestMediaKeySystemAccess(a,[{initDataTypes:["sinf"],videoCapabilities:[{contentType:r}],distinctiveIdentifier:"not-allowed",persistentState:"not-allowed",sessionTypes:["temporary"]}]);i.debug("EME:","set keys");var d=yield o.createMediaKeys();if(!(yield d.setServerCertificate(n)))throw new S._(S._.Code.CDM,"KeySystem "+a+" does not support server certificate.");var u=function(e){var{mediaKeys:t,license:i,logger:a}=e;return function(){var e=k((function*(e){var{type:r,target:s,initDataType:n,initData:l}=e;try{if(a.debug("EME:",r,n),"skd"!==n)throw new S._(S._.Code.CDM,'Received unexpected initialization data type "'+n+'"');if(!l)throw new S._(S._.Code.CDM,"InitData is null");var o=s,d=(0,p.s)({lazy:!0}),u=t.createSession("temporary");a.isLevelEnabled("debug")&&(u.addEventListener("keystatuseschange",(e=>{a.debug("EME "+e.type+":",Array.from(u.keyStatuses.values()))})),u.closed.then((e=>{a.debug("EME KeySession",u.sessionId,"closed, reason",e)}))),u.addEventListener("message",(e=>{a.debug("EME message:",e.messageType),i({message:new Uint8Array(e.message)}).then((e=>(a.debug("EME:","update license"),u.update(e.buffer)))).then(d.resolve).catch(d.reject)})),u.generateRequest(n,l).catch(d.reject),yield d.wait(),yield o.setMediaKeys(t)}catch(t){a.error(t instanceof S._?t:new S._(S._.Code.Other,(0,y.u)(t,{simple:!0}),{cause:t}))}}));return function(t){return e.apply(this,arguments)}}()}(L({},s,{logger:i,mediaKeys:d}));e.initEventHandler=function(){u(...arguments),e.media.encrypted=!0},e.media.addEventListener("encrypted",e.initEventHandler)}}))()}destroy(){delete this.media.encrypted,this.initEventHandler&&(this.media.removeEventListener("encrypted",this.initEventHandler),this.media.removeEventListener("webkitneedkey",this.initEventHandler),this.initEventHandler=void 0),this.media.setMediaKeys&&this.media.setMediaKeys(null),this.media.webkitSetMediaKeys&&this.media.webkitSetMediaKeys(null)}[Symbol.dispose](){return this.destroy()}}var P=i(77848),O=/^(\d+)x(\d+)$/,N=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g;class M{constructor(e){for(var t in"string"==typeof e&&(e=M.parseAttrList(e)),e)e.hasOwnProperty(t)&&(this[t]=e[t])}decimalInteger(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var i=new Uint8Array(t.length/2),a=0;a<t.length/2;a++)i[a]=parseInt(t.slice(2*a,2*a+2),16);return i}return null}hexadecimalIntegerAsNumber(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){var i=this[e];return i?parseFloat(i):t}enumeratedString(e){return this[e]}bool(e){return"YES"===this[e]}decimalResolution(e){var t=O.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){var t,i={};for(N.lastIndex=0;null!==(t=N.exec(e));){var a=t[2];0===a.indexOf('"')&&a.lastIndexOf('"')===a.length-1&&(a=a.slice(1,-1)),i[t[1]]=a}return i}}var _=function(){},U={trace:_,debug:_,log:_,warn:_,info:_,error:_},x=U;var F,Q,W,K=x;(Q=F||(F={})).ID="ID",Q.CLASS="CLASS",Q.START_DATE="START-DATE",Q.DURATION="DURATION",Q.END_DATE="END-DATE",Q.END_ON_NEXT="END-ON-NEXT",Q.PLANNED_DURATION="PLANNED-DURATION",Q.SCTE35_OUT="SCTE35-OUT",Q.SCTE35_IN="SCTE35-IN";class H{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){var i=t.attr;for(var a in i)if(Object.prototype.hasOwnProperty.call(e,a)&&e[a]!==i[a]){K.warn('DATERANGE tag attribute: "'+a+'" does not match for tags with ID: "'+e.ID+'"'),this._badValueForSameId=a;break}e=Object.assign(new M({}),i,e)}if(this.attr=e,this._startDate=new Date(e[F.START_DATE]),F.END_DATE in this.attr){var r=new Date(this.attr[F.END_DATE]);Number.isFinite(r.getTime())&&(this._endDate=r)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;var e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}get duration(){if(F.DURATION in this.attr){var e=this.attr.decimalFloatingPoint(F.DURATION);if(Number.isFinite(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return F.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(F.PLANNED_DURATION):null}get endOnNext(){return this.attr.bool(F.END_ON_NEXT)}get isValid(){return!!this.id&&!this._badValueForSameId&&Number.isFinite(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class V{static fromURL(e,t){return new V(e,t)}static fromURI(e){return new V(e)}constructor(e,t){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,this._uri=t?(0,P.buildAbsoluteURL)(e,t,{alwaysNormalize:!0}):e}get uri(){return this._uri}}class j{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}!function(e){e.AUDIO="audio",e.VIDEO="video",e.AUDIOVIDEO="audiovideo"}(W||(W={}));class G{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[W.AUDIO]:null,[W.VIDEO]:null,[W.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){var i=e.split("@",2),a=[];1===i.length?a[0]=t?t.byteRangeEndOffset:0:a[0]=parseInt(i[1]),a[1]=parseInt(i[0])+a[0],this._byteRange=a}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=(0,P.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class X extends G{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkey=void 0,this.type=void 0,this.loader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.appendedPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new j,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.type=e}get decryptdata(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var e=this.sn;"number"!=typeof e&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&K.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),e=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,e)}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;if(!Number.isFinite(this.programDateTime))return null;var e=Number.isFinite(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;return!(null==(e=this.decryptdata)||!e.keyFormat||!this.decryptdata.uri)}createInitializationVector(e){for(var t=new Uint8Array(16),i=12;i<16;i++)t[i]=e>>8*(15-i)&255;return t}setDecryptDataFromLevelKey(e,t){var i=e;return"AES-128"===(null==e?void 0:e.method)&&e.uri&&!e.iv&&((i=V.fromURI(e.uri)).method=e.method,i.iv=this.createInitializationVector(t),i.keyFormat="identity"),i}setElementaryStreamInfo(e,t,i,a,r,s){void 0===s&&(s=!1);var{elementaryStreams:n}=this,l=n[e];l?(l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,i),l.startDTS=Math.min(l.startDTS,a),l.endDTS=Math.max(l.endDTS,r)):n[e]={startPTS:t,endPTS:i,startDTS:a,endDTS:r,partial:s}}clearElementaryStreamInfo(){var{elementaryStreams:e}=this;e[W.AUDIO]=null,e[W.VIDEO]=null,e[W.AUDIOVIDEO]=null}}class q extends G{constructor(e,t,i,a,r){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new j,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=a;var s=e.enumeratedString("BYTERANGE");s&&this.setByteRange(s,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){var{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}class B{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);var t=this.lastPartSn-e.lastPartSn,i=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!i||!!t,this.advanced=this.endSN>e.endSN||t>0||0===t&&i>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return!!this.fragments.length&&Number.isFinite(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){var e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}var z={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};var Y=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,$=/#EXT-X-MEDIA:(.*)/g,Z=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),J=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),ee=/\.(mp4|m4s|m4v|m4a)$/i;class te{static findGroup(e,t){for(var i=0;i<e.length;i++){var a=e[i];if(a.id===t)return a}}static convertAVC1ToAVCOTI(e){var t=e.split(".");if(t.length>2){var i=t.shift()+".";return i+=parseInt(t.shift()).toString(16),i+=("000"+parseInt(t.shift()).toString(16)).slice(-4)}return e}static resolve(e,t){return P.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static parseMasterPlaylist(e,t){var i,a=[],r=[],s={},n=!1;for(Y.lastIndex=0;null!=(i=Y.exec(e));)if(i[1]){var l,o=new M(i[1]),d={attrs:o,bitrate:o.decimalInteger("AVERAGE-BANDWIDTH")||o.decimalInteger("BANDWIDTH"),name:o.NAME,url:te.resolve(i[2],t)},u=o.decimalResolution("RESOLUTION");u&&(d.width=u.width,d.height=u.height),ie((o.CODECS||"").split(/[ ,]+/).filter((e=>e)),d),d.videoCodec&&-1!==d.videoCodec.indexOf("avc1")&&(d.videoCodec=te.convertAVC1ToAVCOTI(d.videoCodec)),null!=(l=d.unknownCodecs)&&l.length||r.push(d),a.push(d)}else if(i[3]){var h=new M(i[3]);h["DATA-ID"]&&(n=!0,s[h["DATA-ID"]]=h)}return{levels:r.length>0&&r.length<a.length?r:a,sessionData:n?s:null}}static parseMasterPlaylistMedia(e,t,i,a){var r;void 0===a&&(a=[]);var s=[],n=0;for($.lastIndex=0;null!==(r=$.exec(e));){var l=new M(r[1]);if(l.TYPE===i){var o={attrs:l,bitrate:0,id:n++,groupId:l["GROUP-ID"],instreamId:l["INSTREAM-ID"],name:l.NAME||l.LANGUAGE||"",type:i,default:l.bool("DEFAULT"),autoselect:l.bool("AUTOSELECT"),forced:l.bool("FORCED"),lang:l.LANGUAGE,url:l.URI?te.resolve(l.URI,t):""};if(a.length){var d=te.findGroup(a,o.groupId)||a[0];ae(o,d,"audioCodec"),ae(o,d,"textCodec")}s.push(o)}}return s}static parseLevelPlaylist(e,t,i,a,r){var s,n,l,o=new B(t),d=o.fragments,u=null,h=0,c=0,v=0,g=0,m=null,p=new X(a,t),y=-1,f=!1;for(Z.lastIndex=0,o.m3u8=e;null!==(s=Z.exec(e));){f&&(f=!1,(p=new X(a,t)).start=v,p.sn=h,p.cc=g,p.level=i,u&&(p.initSegment=u,p.rawProgramDateTime=u.rawProgramDateTime,u.rawProgramDateTime=null));var E=s[1];if(E){p.duration=parseFloat(E);var S=(" "+s[2]).slice(1);p.title=S||null,p.tagList.push(S?["INF",E,S]:["INF",E])}else if(s[3])Number.isFinite(p.duration)&&(p.start=v,l&&(p.levelkey=l),p.sn=h,p.level=i,p.cc=g,p.urlId=r,d.push(p),p.relurl=(" "+s[3]).slice(1),re(p,m),m=p,v+=p.duration,h++,c=0,f=!0);else if(s[4]){var T=(" "+s[4]).slice(1);m?p.setByteRange(T,m):p.setByteRange(T)}else if(s[5])p.rawProgramDateTime=(" "+s[5]).slice(1),p.tagList.push(["PROGRAM-DATE-TIME",p.rawProgramDateTime]),-1===y&&(y=d.length);else{if(!(s=s[0].match(J))){K.warn("No matches on slow regex match for level playlist!");continue}for(n=1;n<s.length&&void 0===s[n];n++);var D=(" "+s[n]).slice(1),b=(" "+s[n+1]).slice(1),w=s[n+2]?(" "+s[n+2]).slice(1):"";switch(D){case"PLAYLIST-TYPE":o.type=b.toUpperCase();break;case"MEDIA-SEQUENCE":h=o.startSN=parseInt(b);break;case"SKIP":var L=new M(b),A=L.decimalInteger("SKIPPED-SEGMENTS");if(Number.isFinite(A)){o.skippedSegments=A;for(var k=A;k--;)d.unshift(null);h+=A}var R=L.enumeratedString("RECENTLY-REMOVED-DATERANGES");R&&(o.recentlyRemovedDateranges=R.split("\t"));break;case"TARGETDURATION":o.targetduration=parseFloat(b);break;case"VERSION":o.version=parseInt(b);break;case"EXTM3U":break;case"ENDLIST":o.live=!1;break;case"#":(b||w)&&p.tagList.push(w?[b,w]:[b]);break;case"DISCONTINUITY":g++,p.tagList.push(["DIS"]);break;case"GAP":p.tagList.push([D]);break;case"BITRATE":p.tagList.push([D,b]);break;case"DATERANGE":var I=new M(b),C=new H(I,o.dateRanges[I.ID]);C.isValid||o.skippedSegments?o.dateRanges[C.id]=C:K.warn('Ignoring invalid DATERANGE tag: "'+b+'"'),p.tagList.push(["EXT-X-DATERANGE",b]);break;case"DISCONTINUITY-SEQUENCE":g=parseInt(b);break;case"KEY":var O,N=new M(b),_=N.enumeratedString("METHOD"),U=N.URI,x=N.hexadecimalInteger("IV"),F=N.enumeratedString("KEYFORMATVERSIONS"),Q=N.enumeratedString("KEYID"),W=null!=(O=N.enumeratedString("KEYFORMAT"))?O:"identity";if(["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"].indexOf(W)>-1){K.warn("Keyformat "+W+" is not supported from the manifest");continue}if("identity"!==W)continue;_&&(l=V.fromURL(t,U),U&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(_)>=0&&(l.method=_,l.keyFormat=W,Q&&(l.keyID=Q),F&&(l.keyFormatVersions=F),l.iv=x));break;case"START":var j=new M(b).decimalFloatingPoint("TIME-OFFSET");Number.isFinite(j)&&(o.startTimeOffset=j);break;case"MAP":var G=new M(b);if(p.duration){var z=new X(a,t);se(z,G,i,l),u=z,p.initSegment=u,u.rawProgramDateTime&&!p.rawProgramDateTime&&(p.rawProgramDateTime=u.rawProgramDateTime)}else se(p,G,i,l),u=p,f=!0;break;case"SERVER-CONTROL":var Y=new M(b);o.canBlockReload=Y.bool("CAN-BLOCK-RELOAD"),o.canSkipUntil=Y.optionalFloat("CAN-SKIP-UNTIL",0),o.canSkipDateRanges=o.canSkipUntil>0&&Y.bool("CAN-SKIP-DATERANGES"),o.partHoldBack=Y.optionalFloat("PART-HOLD-BACK",0),o.holdBack=Y.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var $=new M(b);o.partTarget=$.decimalFloatingPoint("PART-TARGET");break;case"PART":var te=o.partList;te||(te=o.partList=[]);var ie=c>0?te[te.length-1]:void 0,ae=c++,ne=new q(new M(b),p,t,ae,ie);te.push(ne),p.duration+=ne.duration;break;case"PRELOAD-HINT":var le=new M(b);o.preloadHint=le;break;case"RENDITION-REPORT":var oe=new M(b);o.renditionReports=o.renditionReports||[],o.renditionReports.push(oe);break;default:K.warn("line parsed but not handled: "+s)}}}m&&!m.relurl?(d.pop(),v-=m.duration,o.partList&&(o.fragmentHint=m)):o.partList&&(re(p,m),p.cc=g,o.fragmentHint=p);var de=d.length,ue=d[0],he=d[de-1];if((v+=o.skippedSegments*o.targetduration)>0&&de&&he){o.averagetargetduration=v/de;var ce=he.sn;o.endSN="initSegment"!==ce?ce:0,ue&&(o.startCC=ue.cc,ue.initSegment||o.fragments.every((e=>e.relurl&&function(e){var t,i;return ee.test(null!=(t=null==(i=P.parseURL(e))?void 0:i.path)?t:"")}(e.relurl)))&&(K.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(p=new X(a,t)).relurl=he.relurl,p.level=i,p.sn="initSegment",ue.initSegment=p,o.needSidxRanges=!0))}else o.endSN=0,o.startCC=0;return o.fragmentHint&&(v+=o.fragmentHint.duration),o.totalduration=v,o.endCC=g,y>0&&function(e,t){for(var i=e[t],a=t;a--;){var r=e[a];if(!r)return;r.programDateTime=i.programDateTime-1e3*r.duration,i=r}}(d,y),o}}function ie(e,t){["video","audio","text"].forEach((i=>{var a=e.filter((e=>function(e,t){var i=z[t];return!!i&&!0===i[e.slice(0,4)]}(e,i)));if(a.length){var r=a.filter((e=>0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)));t[i+"Codec"]=r.length>0?r[0]:a[0],e=e.filter((e=>-1===a.indexOf(e)))}})),t.unknownCodecs=e}function ae(e,t,i){var a=t[i];a&&(e[i]=a)}function re(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):(null==t?void 0:t.programDateTime)&&(e.programDateTime=t.endProgramDateTime),Number.isFinite(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function se(e,t,i,a){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=i,e.sn="initSegment",a&&(e.levelkey=a),e.initSegment=null}var ne=i(13915),le=i(8271);function oe(){return oe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)({}).hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},oe.apply(null,arguments)}function de(e,t,i,a,r,s,n){try{var l=e[s](n),o=l.value}catch(e){return void i(e)}l.done?t(o):Promise.resolve(o).then(a,r)}function ue(e){return function(){var t=this,i=arguments;return new Promise((function(a,r){var s=e.apply(t,i);function n(e){de(s,a,r,n,l,"next",e)}function l(e){de(s,a,r,n,l,"throw",e)}n(void 0)}))}}var he=e=>("use-credentials"===e?"include":"anonymous"===e&&"omit")||void 0;function ce(){return ce=ue((function*(e,t){var i=yield fetch(e,{credentials:he(t)}),r=yield i.text();if(r.indexOf("#EXTINF:")>0||r.indexOf("#EXT-X-TARGETDURATION:")>0)return[(0,ne.L)([{url:i.url||e,bitrate:1}]),{}];var s=te.parseMasterPlaylist(r,i.url||e),n=(0,ne.L)(s.levels),l=te.parseMasterPlaylistMedia(r,e,"AUDIO"),o=(0,le.X)(l);return[(0,a.R)(n)?void 0:n,o]})),ce.apply(this,arguments)}function ve(){return ve=ue((function*(e,t){var i=yield fetch(e.url,{credentials:he(t)}),a=yield i.text();return te.parseLevelPlaylist(a,e.url,e.level,"main",e.level)})),ve.apply(this,arguments)}class ge extends g.n{constructor(e){void 0===e&&(e=void 0),super("hls","NativeHlsDriver",e),this.disableAudio=!1,this.liveSeekLength=0,this.liveLatency=0,this.targetDuration=0,this.playback="native",this.reloadMediaOnReplay=(0,r.n)()&&(0,s.U)()}stopWaitSourceTimer(){this.waitSourceTimer&&(this.waitSourceTimer.stop(),this.waitSourceTimer=void 0)}getLevelsAndAudio(e,t,i){var r=this;return ue((function*(){try{var[s,n]=yield function(e,t){return ce.apply(this,arguments)}(e,t);return!s||!n||(0,a.R)(s)||(0,a.R)(n)||i?[s,n]:[{},{}]}catch(t){return r.handleError(t,{severity:"warning",path:"getLevelsAndAudio:"+e}),[{},{}]}}))()}selectTrackSource(e,t){var{masterSource:i,trackSourceSelector:a}=this;if(i&&a){if((null==e||"auto"===e)&&null==t&&!this.disableAudio)return i;if(0===e){var r=this.qualityLevels[e];if(null!=r&&r.url)return r.url}if("object"==typeof a){var s,n,l="auto"===e?void 0:e,o=new URL(i);return l&&o.searchParams.set(a.params.quality,String(null!=(s=null==(n=a.qualityMap)?void 0:n[l])?s:l)),this.disableAudio?o.searchParams.set(a.params.audio,"@disable"):null!=t&&o.searchParams.set(a.params.audio,t),o.toString()}return a("auto"===e?void 0:e,t,{masterSource:i,qualityLevels:this.qualityLevels,audioTracks:this.audioTracks})}}getActualQuality(){var e;if(this.media)return(null!=(e=(0,u.j)({width:this.media.videoWidth,height:this.media.videoHeight}))?e:this.media.videoHeight)||void 0}updateActualQuality(){var e=this.getActualQuality();null!=e&&e!==this.actualQuality&&(this.actualQuality=e,this.emit(this.Events.QualityChanged,{quality:this.actualQuality,auto:!0}))}attachCore(e,t,i){var a=this;return ue((function*(){try{var r,s,{drm:l}=null!=(r=i.settings)?r:{},o=i.sourceParams?(0,d.u)(t.src,i.sourceParams):t.src,u=null!=l&&l.auth?oe({},t,{src:(yield l.auth(o))||o}):oe({},t,{src:o});a.masterSource=u.src;var[g,p]=yield a.getLevelsAndAudio(a.masterSource,e.crossOrigin,!!u.selector);if(!g&&i.waitSource)return void(a.waitSourceTimer||(a.waitSourceTimer=(0,m.e)(i.waitSource,(()=>{a.attachCore(e,u,i)})),a.emit(a.Events.SourceWaiting)));a.stopWaitSourceTimer();var y=oe({auto:{level:-1,url:a.masterSource}},g,u.q0&&{0:{level:NaN,url:u.q0}});a.qualityLevels=y,a.audioTracks=p,a.trackSourceSelector=u.selector,a.emit(a.Events.MetadataChanged,{qualityLevels:y,audioTracks:p,masterSource:a.masterSource});var f="function"==typeof i.quality?i.quality(y):i.quality,[E,S]=(0,h.t)(y,f),T="function"==typeof i.audioTrack?i.audioTrack(p):i.audioTrack,D=!1===T?void 0:(0,c.j)(p,T,{tryDefault:!0,tryFirst:!0});a.currentQuality=E,a.currentAudio=null==D?void 0:D.language,a.disableAudio=!a.currentAudio&&!1===T;var b=a.selectTrackSource(a.currentQuality,a.currentAudio)||S.url;"auto"!==a.currentQuality&&(a.actualQuality=a.currentQuality);var w=a.eventListeners.scope(e).on("error",(e=>a.handleError(e))).once("loadeddata",(()=>{var t=!1;a.setLive(e.duration===1/0);var i=function(){var i=ue((function*(){var i=g&&Object.values(g)[0];if(i){var r=yield function(e,t){return ve.apply(this,arguments)}(i,e.crossOrigin);a.liveSeekLength=Math.floor(r.totalduration),a.targetDuration=r.targetduration,a.liveLatency=Math.floor(3*a.targetDuration),t=!0}else a.liveSeekLength=(0,n.BN)(e.seekable)||0,a.targetDuration=0,a.liveLatency=0}));return function(){return i.apply(this,arguments)}}();null==a.actualQuality&&(a.actualQuality=a.getActualQuality()),w.on("resize",(()=>{a.isSourceChanging()||a.updateActualQuality()})).on("progress",(()=>{t&&i()})).on("durationchange",(()=>{a.setLive(e.duration===1/0)}));var r=()=>{a.emit(a.Events.Loaded,{qualityLevels:y,quality:E,audioTracks:p,audioTrack:null==D?void 0:D.language,masterSource:a.masterSource,liveState:a.getLiveState(),drm:!!e.encrypted}),"auto"===a.currentQuality&&null!=a.actualQuality&&a.emit(a.Events.QualityChanged,{quality:a.actualQuality,auto:!0})},s=()=>{if(e.videoHeight)r();else{var t=setTimeout(r,0);a.cleaners.push((()=>clearTimeout(t)))}};a.isLive()?i().catch((e=>{a.handleError(e,{severity:"warning",path:"updateLiveInfo"})})).finally(s):s()}));if(null!=l&&null!=(s=l.eme)&&s.license){var L=new C(e,oe({},l.eme,{keySystem:"com.apple.fps",contentType:"application/vnd.apple.mpegURL",logger:a.logger}));a.cleaners.push((()=>L.destroy())),yield L.init()}e.setAttribute("src",b),e.load()}catch(i){throw new v.X(e.src||a.masterSource||t.src,{cause:i})}}))()}detachCore(){this.stopWaitSourceTimer(),this.masterSource=void 0,this.qualityLevels=void 0,this.audioTracks=void 0,this.trackSourceSelector=void 0,this.currentQuality=void 0,this.actualQuality=void 0,this.currentAudio=void 0,this.disableAudio=!1,this.liveSeekLength=0,this.targetDuration=0,this.liveLatency=0}getDuration(){return this.media&&this.isLive()?Math.max((0,n.Q5)(this.media.seekable),(0,n.Q5)(this.media.buffered)):super.getDuration()}getLiveLatency(){return this.liveLatency}getLiveSeekLength(){return this.isLive()?this.liveSeekLength:0}getLiveEdgePosition(){return this.isLive()&&this.media?(0,n.Q5)(this.media.seekable):super.getLiveEdgePosition()}atLiveEdge(e,t){return void 0===e&&(e=this.getCurrentTime()),void 0===t&&(t=this.getLiveEdgePosition()),Math.ceil(e)>=Math.floor(t-this.targetDuration)}getVideoQuality(){return this.currentQuality}isValidVideoQuality(e){var t;return null!=(null==(t=this.qualityLevels)||null==(t=t[e])?void 0:t.url)}switchSource(e){var t=this;return ue((function*(){var{media:i}=t;if(i&&i.src!==e){t.setSourceChanging(!0);var{currentTime:a,paused:r,playbackRate:s,poster:n}=i;r||i.pause();try{i.poster=a>0?(0,l.W9)(i,{width:i.videoWidth,height:i.videoHeight}):n}catch(e){t.handleError(e,{severity:"warning",path:"switchSource:takeSnapshot"})}i.setAttribute("src",e);try{yield(0,o.Y)(i,{time:a,playbackRate:s,poster:n,autoPlay:!r})}catch(e){t.handleError(e,{severity:"warning",path:"switchSource:reloadVideo"})}finally{t.setSourceChanging(!1)}}}))()}setVideoQuality(e){var t;if(e!==this.currentQuality){var{qualityLevels:i,currentAudio:a}=this;if(i&&this.isValidVideoQuality(e)&&!this.isSourceChanging()){var r=this.selectTrackSource(e,a)||(null==(t=i[e])?void 0:t.url);r&&this.switchSource(r).then((()=>{this.currentQuality=e,"auto"!==this.currentQuality&&this.actualQuality!==this.currentQuality&&(this.actualQuality=this.currentQuality),this.emit(this.Events.QualityChanged,{quality:e,auto:!1}),"auto"===this.currentQuality&&this.updateActualQuality()}))}}}getAudioTrack(){return this.currentAudio}isValidAudioTrack(e){var t;return null!=(null==(t=this.audioTracks)||null==(t=t[e])?void 0:t.index)}setAudioTrack(e){var t;if(e!==this.currentAudio&&!this.disableAudio){var{audioTracks:i,currentQuality:a}=this;if(i&&this.isValidAudioTrack(e)&&!this.isSourceChanging()){var r=this.selectTrackSource(a,e)||(null==(t=i[e])?void 0:t.url);r&&this.switchSource(r).then((()=>{this.currentAudio=e,this.emit(this.Events.AudioTrackChanged,{lang:e})}))}}}setMaxQuality(){}setMaxAbrQuality(){}destroyCore(){}}},77848:function(e){var t,i,a,r,s;t=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,a=/(?:\/|^)\.(?=\/)/g,r=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(e,t,a){if(a=a||{},e=e.trim(),!(t=t.trim())){if(!a.alwaysNormalize)return e;var r=s.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=s.normalizePath(r.path),s.buildURLFromParts(r)}var n=s.parseURL(t);if(!n)throw new Error("Error trying to parse relative URL.");if(n.scheme)return a.alwaysNormalize?(n.path=s.normalizePath(n.path),s.buildURLFromParts(n)):t;var l=s.parseURL(e);if(!l)throw new Error("Error trying to parse base URL.");if(!l.netLoc&&l.path&&"/"!==l.path[0]){var o=i.exec(l.path);l.netLoc=o[1],l.path=o[2]}l.netLoc&&!l.path&&(l.path="/");var d={scheme:l.scheme,netLoc:n.netLoc,path:null,params:n.params,query:n.query,fragment:n.fragment};if(!n.netLoc&&(d.netLoc=l.netLoc,"/"!==n.path[0]))if(n.path){var u=l.path,h=u.substring(0,u.lastIndexOf("/")+1)+n.path;d.path=s.normalizePath(h)}else d.path=l.path,n.params||(d.params=l.params,n.query||(d.query=l.query));return null===d.path&&(d.path=a.alwaysNormalize?s.normalizePath(n.path):n.path),s.buildURLFromParts(d)},parseURL:function(e){var i=t.exec(e);return i?{scheme:i[1]||"",netLoc:i[2]||"",path:i[3]||"",params:i[4]||"",query:i[5]||"",fragment:i[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(r,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s},88913:function(e,t,i){"use strict";i.d(t,{X:function(){return s}});var a=i(16683);function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)({}).hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},r.apply(null,arguments)}class s extends a.D{constructor(e,t){void 0===t&&(t=void 0),super(s,"Error during loading source: "+e+".",r({},t,{name:"LoadError"}))}}}}]);