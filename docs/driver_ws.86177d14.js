"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[134],{3553:function(e,t,i){i.d(t,{I:function(){return l}});var r=i(55510),n=i.n(r),s=i(52178);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},a.apply(null,arguments)}function o(e,t,i,r,n,s,a){try{var o=e[s](a),l=o.value}catch(e){return void i(e)}o.done?t(l):Promise.resolve(l).then(r,n)}class l extends s.I{isIdleMode(){return this.idleMedia===this.media}constructor(e,t){super(t),this.driver=e,this.idleMedia=(()=>{var e=document.createElement("video");return e.preload="metadata",e})(),this.idleOptions={quality:void 0,initialTime:void 0,autoPlay:!1,driverSettings:{hls:{startLevel:0,initialLiveManifestSize:0,liveSyncDurationCount:0,lowLatencyMode:!1}}},this.on(s.I.Events.LiveStateChanged,(t=>{var{data:i}=t;e.isSourceChanging()||e.emit(e.Events.LiveStateChanged,i)})).on(s.I.Events.QualityChanged,(t=>{var{data:i}=t;this.isIdleMode()||e.isSourceChanging()||e.emit(e.Events.QualityChanged,i)})).on(s.I.Events.AudioTrackChanged,(t=>{var{data:i}=t;this.isIdleMode()||e.isSourceChanging()||e.emit(e.Events.AudioTrackChanged,i)}))}load(e){var t,i=()=>super.load,r=this;return(t=function*(){var t=r.isIdleMode()?a({},e,r.idleOptions,{driverSettings:t=>function(e,t,i){var r="function"==typeof t?t(e):t,s="function"==typeof i?i(e):i;return n()(null!=r?r:{},null!=s?s:{})}(t,e.driverSettings,r.idleOptions.driverSettings)}):e;return i().call(r,t)},function(){var e=this,i=arguments;return new Promise((function(r,n){var s=t.apply(e,i);function a(e){o(s,r,n,a,l,"next",e)}function l(e){o(s,r,n,a,l,"throw",e)}a(void 0)}))})()}}},9624:function(e,t,i){i.d(t,{B:function(){return w}});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},r(e,t)};function n(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function s(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,s=i.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(o){n={error:o}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return a}var a=function(e,t){this.target=t,this.type=e},o=function(e){function t(t,i){var r=e.call(this,"error",i)||this;return r.message=t.message,r.error=t,r}return n(t,e),t}(a),l=function(e){function t(t,i,r){void 0===t&&(t=1e3),void 0===i&&(i="");var n=e.call(this,"close",r)||this;return n.wasClean=!0,n.code=t,n.reason=i,n}return n(t,e),t}(a),h=function(){if("undefined"!=typeof WebSocket)return WebSocket},d={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+4e3*Math.random(),minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0,startClosed:!1,debug:!1},u=function(){function e(e,t,i){var r=this;void 0===i&&(i={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(e){r._debug("open event");var t=r._options.minUptime,i=void 0===t?d.minUptime:t;clearTimeout(r._connectTimeout),r._uptimeTimeout=setTimeout((function(){return r._acceptOpen()}),i),r._ws.binaryType=r._binaryType,r._messageQueue.forEach((function(e){return r._ws.send(e)})),r._messageQueue=[],r.onopen&&r.onopen(e),r._listeners.open.forEach((function(t){return r._callEventListener(e,t)}))},this._handleMessage=function(e){r._debug("message event"),r.onmessage&&r.onmessage(e),r._listeners.message.forEach((function(t){return r._callEventListener(e,t)}))},this._handleError=function(e){r._debug("error event",e.message),r._disconnect(void 0,"TIMEOUT"===e.message?"timeout":void 0),r.onerror&&r.onerror(e),r._debug("exec error listeners"),r._listeners.error.forEach((function(t){return r._callEventListener(e,t)})),r._connect()},this._handleClose=function(e){r._debug("close event"),r._clearTimeouts(),r._shouldReconnect&&r._connect(),r.onclose&&r.onclose(e),r._listeners.close.forEach((function(t){return r._callEventListener(e,t)}))},this._url=e,this._protocols=t,this._options=i,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(e,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CONNECTING",{get:function(){return e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OPEN",{get:function(){return e.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSING",{get:function(){return e.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSED",{get:function(){return e.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferedAmount",{get:function(){return this._messageQueue.reduce((function(e,t){return"string"==typeof t?e+=t.length:t instanceof Blob?e+=t.size:e+=t.byteLength,e}),0)+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?e.CLOSED:e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),e.prototype.close=function(e,t){void 0===e&&(e=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),this._ws?this._ws.readyState!==this.CLOSED?this._ws.close(e,t):this._debug("close: already closed"):this._debug("close enqueued: no ws instance")},e.prototype.reconnect=function(e,t){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,this._ws&&this._ws.readyState!==this.CLOSED?(this._disconnect(e,t),this._connect()):this._connect()},e.prototype.send=function(e){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",e),this._ws.send(e);else{var t=this._options.maxEnqueuedMessages,i=void 0===t?d.maxEnqueuedMessages:t;this._messageQueue.length<i&&(this._debug("enqueue",e),this._messageQueue.push(e))}},e.prototype.addEventListener=function(e,t){this._listeners[e]&&this._listeners[e].push(t)},e.prototype.dispatchEvent=function(e){var t,i,r=this._listeners[e.type];if(r)try{for(var n=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],i=0;return t?t.call(e):{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}}}(r),s=n.next();!s.done;s=n.next()){var a=s.value;this._callEventListener(e,a)}}catch(o){t={error:o}}finally{try{s&&!s.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}return!0},e.prototype.removeEventListener=function(e,t){this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter((function(e){return e!==t})))},e.prototype._debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._options.debug&&console.log.apply(console,function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e}(["RWS>"],e))},e.prototype._getNextDelay=function(){var e=this._options,t=e.reconnectionDelayGrowFactor,i=void 0===t?d.reconnectionDelayGrowFactor:t,r=e.minReconnectionDelay,n=void 0===r?d.minReconnectionDelay:r,s=e.maxReconnectionDelay,a=void 0===s?d.maxReconnectionDelay:s,o=0;return this._retryCount>0&&(o=n*Math.pow(i,this._retryCount-1))>a&&(o=a),this._debug("next delay",o),o},e.prototype._wait=function(){var e=this;return new Promise((function(t){setTimeout(t,e._getNextDelay())}))},e.prototype._getNextUrl=function(e){if("string"==typeof e)return Promise.resolve(e);if("function"==typeof e){var t=e();if("string"==typeof t)return Promise.resolve(t);if(t.then)return t}throw Error("Invalid URL")},e.prototype._connect=function(){var e=this;if(!this._connectLock&&this._shouldReconnect){this._connectLock=!0;var t=this._options,i=t.maxRetries,r=void 0===i?d.maxRetries:i,n=t.connectionTimeout,s=void 0===n?d.connectionTimeout:n,a=t.WebSocket,o=void 0===a?h():a;if(this._retryCount>=r)this._debug("max retries reached",this._retryCount,">=",r);else{if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),void 0===(l=o)||!l||2!==l.CLOSING)throw Error("No valid WebSocket class provided");var l;this._wait().then((function(){return e._getNextUrl(e._url)})).then((function(t){e._closeCalled||(e._debug("connect",{url:t,protocols:e._protocols}),e._ws=e._protocols?new o(t,e._protocols):new o(t),e._ws.binaryType=e._binaryType,e._connectLock=!1,e._addListeners(),e._connectTimeout=setTimeout((function(){return e._handleTimeout()}),s))}))}}},e.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new o(Error("TIMEOUT"),this))},e.prototype._disconnect=function(e,t){if(void 0===e&&(e=1e3),this._clearTimeouts(),this._ws){this._removeListeners();try{this._ws.close(e,t),this._handleClose(new l(e,t,this))}catch(i){}}},e.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},e.prototype._callEventListener=function(e,t){"handleEvent"in t?t.handleEvent(e):t(e)},e.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},e.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},e.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},e}();const c=u;var g,v=i(58245),f=i(69805),m=i(90668),p=["logger","protocols","binaryType","idleTimeout","halfOpenDetection","startClosed"];function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},y.apply(null,arguments)}class w extends v.b{get Events(){return w.Events}constructor(e,t){super(),this.logger=void 0,this.ws=void 0,this.listener=void 0,this.reconnectOnIdle=void 0,this.halfOpen=void 0;var i=null!=t?t:{},{logger:r,protocols:n,binaryType:s,idleTimeout:a,halfOpenDetection:o,startClosed:l}=i,h=function(e,t){if(null==e)return{};var i={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;i[r]=e[r]}return i}(i,p);this.logger=null!=r?r:console,this.ws=new c(e,n,y({},h,{startClosed:!0})),null!=s&&(this.ws.binaryType=s),this.listener=new m.H(this.ws),a&&a>0&&(this.reconnectOnIdle=(0,f.N)((()=>{this.logger.info("WS connection reconnecting after "+a+"ms due to inactivity."),this.ws.reconnect()}),a)),this.halfOpen=(()=>{if(o){var{pingTimeout:e=12e3,outMessage:t=()=>JSON.stringify({type:"pong"}),inMessageFilter:i=e=>e&&"object"==typeof e&&"ping"===e.type}=o,r=(0,f.N)((()=>{this.logger.info("WS connection reconnecting after "+e+"ms due to the probability of a half-open connection."),this.ws.reconnect()}),e),n=()=>{r(),this.ws.send("function"!=typeof t||t instanceof Blob?t:t())};return{heartbeat:n,cancel:()=>r.cancel(),onMessage:e=>{var{data:t}=e;i(t)?n():r()}}}})(),this.listener.on("open",(()=>{var e;this.reconnectOnIdle&&this.reconnectOnIdle(),null!=(e=this.halfOpen)&&e.heartbeat(),this.emit(this.Events.Connected)})).on("close",(e=>{var i,r,{code:n}=e;null!=(i=this.reconnectOnIdle)&&i.cancel(),null!=(r=this.halfOpen)&&r.cancel(),null!=(null==t?void 0:t.maxRetries)&&this.ws.readyState===this.ws.CLOSED&&this.ws.retryCount===t.maxRetries&&this.close(n,"Failed to connect after "+t.maxRetries+" attempts.")})).on("message",(e=>{var t;this.reconnectOnIdle&&this.reconnectOnIdle(),null!=(t=this.halfOpen)&&t.onMessage(e),this.emit(this.Events.Message,e)})).on("error",(e=>{var{error:t,message:i}=e;this.emit(this.Events.Error,{error:t,message:i})})),this.halfOpen&&(this.isConnected()||this.ws.readyState===this.ws.CONNECTING)&&this.halfOpen.heartbeat(),l||this.connect()}isConnected(){return this.ws.readyState===this.ws.OPEN}getUrl(){return this.ws.url}connect(){this.ws.reconnect()}send(e){if(!this.ws)throw new Error("The object is not connected yet.");this.ws.send(e)}close(e,t){var i=!!this.ws;try{this.reconnectOnIdle&&this.reconnectOnIdle.cancel(),this.halfOpen&&this.halfOpen.cancel(),this.ws.close(e,t)}catch(e){this.logger.warn(e)}i&&this.emit(this.Events.Closed,t?{reason:t}:void 0)}destroy(){this.close(),this.listener.removeAllListeners(),this.removeAllListeners()}[Symbol.dispose](){this.destroy()}}(function(e){e.Connected="Connected",e.Message="Message",e.Error="Error",e.Closed="Closed"})((g=w||(w={})).Events||(g.Events={}))},30732:function(e,t,i){i.d(t,{j:function(){return o}});var r=i(96157),n=i(45006),s=i(46338);function a(e,t,i,r,n,s,a){try{var o=e[s](a),l=o.value}catch(e){return void i(e)}o.done?t(l):Promise.resolve(l).then(r,n)}function o(e,t){return l.apply(this,arguments)}function l(){var e;return e=function*(e,t){var i=e.getMediaElement();t.onStart();var{currentTime:a,paused:o,playbackRate:l,poster:h}=i;o||i.pause();try{i.poster=a>0?(0,r.W9)(i,{width:i.videoWidth,height:i.videoHeight}):h}catch(t){e.emit(e.Events.Error,{type:"generic",severity:"warning",error:t,path:"dvrSeeking:takeSnapshot",state:e.getStateInfo()})}try{(0,n.a)(i),t.isIdleMode()?yield t.onDvrSeek(i):yield t.onNormalSeek(i),yield(0,s.F)(i,{playbackRate:l,poster:h}).catch((e=>t.onError(e,"warning"))),!o&&i.paused&&(yield i.play().catch((e=>t.onError(e,"warning"))))}catch(e){t.onError(e,"fatal")}finally{t.onEnd()}return i.currentTime},l=function(){var t=this,i=arguments;return new Promise((function(r,n){var s=e.apply(t,i);function o(e){a(s,r,n,o,l,"next",e)}function l(e){a(s,r,n,o,l,"throw",e)}o(void 0)}))},l.apply(this,arguments)}},38105:function(e,t,i){i.d(t,{n:function(){return W}});var r=i(55823),n=i(58245),s=i(33612),a=i(70866),o=i(85186),l=i(9374),h=i(61542),d=i(86275),u=i(35018),c=i(82128),g=i(45006),v=i(37998),f=i(2593),m=i(18168);function p(e){switch(e){case MediaError.MEDIA_ERR_NETWORK:return"network";case MediaError.MEDIA_ERR_DECODE:case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:return"media";default:return"generic"}}var y=i(86503),w=i(18430),b=i(47390),E=i(67106);function C(e,t,i,r,n,s,a){try{var o=e[s](a),l=o.value}catch(e){return void i(e)}o.done?t(l):Promise.resolve(l).then(r,n)}function S(e,t){var i,r,{url:n,interval:s=6e4,responseHandler:a=e=>Promise.resolve(200===e.status)}=e;return(0,E.s)({interval:()=>s,callback:(i=function*(){var e=yield fetch(n);(yield a(e))&&t()},r=function(){var e=this,t=arguments;return new Promise((function(r,n){var s=i.apply(e,t);function a(e){C(s,r,n,a,o,"next",e)}function o(e){C(s,r,n,a,o,"throw",e)}a(void 0)}))},function(){return r.apply(this,arguments)}),waitCallback:!0,autostart:!1})}var _=i(4556),k=i(90668);function L(){return L=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},L.apply(null,arguments)}class T extends n.b{constructor(e,t){void 0===t&&(t={}),super(),this.stalled=!1,this.startStalledTime=0,this.cancel=()=>{this.setStalled(!1),this.resetStallDetected()},this.progressHandler=()=>{var e=this.listener.target;this.stalledBuffer&&this.stalledBuffer.start===(0,c.BC)(e.buffered)&&this.stalledBuffer.end===(0,c.Q5)(e.buffered)||this.cancel()},this.timeupdateHandler=()=>{var e=this.listener.target;e.paused&&!e.seeking&&this.setStalledDelayed.isPending?this.resetStallDetected():this.setStalledDelayed.isPending?this.stallDetected():this.listener.off("timeupdate",this.timeupdateHandler)},this.poll=()=>{var e=this.listener.target;!this.isStalled()&&e.buffered.length>0&&(e.seeking||e.readyState<=e.HAVE_CURRENT_DATA&&e.networkState===e.NETWORK_LOADING)&&this.stallDetected()},this.options=L({},t,{delay:t.delay||5e3}),this.setStalledDelayed=(0,_.s)((()=>this.setStalled(!0)),this.options.delay),this.listener=(e instanceof HTMLMediaElement?new k.H(e):e).on("waiting",this.poll).on("seeking",this.poll)}stallDetected(){var e=this.listener.target;this.stalledBuffer={start:(0,c.BC)(e.buffered),end:(0,c.Q5)(e.buffered)},this.startStalledTime=Date.now(),this.setStalledDelayed(),this.listener.on("progress",this.progressHandler).on("timeupdate",this.timeupdateHandler).on("emptied",this.cancel)}resetStallDetected(){this.stalledBuffer=void 0,this.startStalledTime=0,this.listener.off("progress",this.progressHandler),this.listener.off("timeupdate",this.timeupdateHandler),this.listener.off("emptied",this.cancel),this.setStalledDelayed.cancel()}isStalled(){return this.stalled}setStalled(e){if(this.stalled!==e)if(this.stalled=e,this.stalled)this.emit("statechanged",{stalled:this.stalled,duration:0});else{var t=Math.max(Date.now()-this.startStalledTime,0);this.emit("statechanged",{stalled:this.stalled,duration:t})}}destroy(){this.resetStallDetected(),this.listener.off("waiting",this.poll),this.listener.off("seeking",this.poll),this.stalled=!1,this.emit("destroy"),this.removeAllListeners()}[Symbol.dispose](){return this.destroy()}}var O,D=i(54548);function M(){return M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},M.apply(null,arguments)}class R extends n.b{constructor(e,t){var i,r;void 0===t&&(t={}),super(),this.waiting=!1,this.lastTime=-1,this.startWaitingTime=0,this.startWaiting=()=>{this.waiting||this.setWaitingDelayed.isPending||(this.lastTime=this.listener.target.currentTime,this.startWaitingTime=Date.now(),this.setWaitingDelayed(),this.listener.on("timeupdate",this.timeupdateHandler))},this.stopWaiting=()=>{this.setWaitingDelayed.cancel(),this.waiting&&(this.setWaiting(!1),this.listener.off("timeupdate",this.timeupdateHandler))},this.timeupdateHandler=()=>{var e=this.listener.target;e.paused?e.seeking&&!this.options.stopOnPauseIfSeeking||this.stopWaiting():this.lastTime!==e.currentTime&&this.stopWaiting()},this.options=M({},t,{delay:null!=(i=t.delay)?i:500,stopOnPauseIfSeeking:null!=(r=t.stopOnPauseIfSeeking)&&r}),this.setWaitingDelayed=(0,D.G)((0,_.s)((()=>this.setWaiting(!0)),this.options.delay),(()=>{this.lastTime=this.listener.target.currentTime,this.startWaitingTime=Date.now()})),this.listener=e instanceof HTMLMediaElement?new k.H(e):e,this.listener.on("waiting",this.startWaiting),this.listener.on("seeking",this.startWaiting)}setWaiting(e){if(this.waiting!==e)if(this.waiting=e,this.waiting)this.emit("statechanged",{waiting:!0,duration:0});else{var t=Math.max(Date.now()-this.startWaitingTime,0);this.lastTime=-1,this.startWaitingTime=0,this.emit("statechanged",{waiting:!1,duration:t})}}isWaiting(){return this.waiting}destroy(){this.listener.off("timeupdate",this.timeupdateHandler),this.listener.off("waiting",this.startWaiting),this.listener.off("seeking",this.startWaiting),this.waiting=!1,this.lastTime=-1,this.startWaitingTime=0,this.emit("destroy"),this.removeAllListeners()}[Symbol.dispose](){return this.destroy()}}function P(){return P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},P.apply(null,arguments)}function x(e,t,i,r,n,s,a){try{var o=e[s](a),l=o.value}catch(e){return void i(e)}o.done?t(l):Promise.resolve(l).then(r,n)}function B(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var s=e.apply(t,i);function a(e){x(s,r,n,a,o,"next",e)}function o(e){x(s,r,n,a,o,"throw",e)}a(void 0)}))}}class W extends n.b{get Events(){return W.Events}constructor(e,t,i){super(),this.format=e,this.eventListeners=new d.g,this.cleaners=[],this.loaded=!1,this.live=!1,this.played=!1,this.actuallyPlayed=!1,this.seeked=!1,this.sourceChanging=!1,this.suspended=!1,this.reloadMediaOnReplay=!1,this.networkStateController={isOnline:()=>!0},this.name=t||this.constructor.name,this.logger=null!=i?i:(0,f.t)(this.name);var r=(0,h.d)(5);this.attachMutex=new s.e(this.name+"."+r+".",this.logger),this.detachMutex=new s.e(this.name+"."+r+".",this.logger),this.destroyMutex=new s.e(this.name+"."+r+".",this.logger),this.on(this.Events.Loaded,(()=>{this.loaded=!0,this.emit(this.Events.LiveStateChanged,this.getLiveState())}))}get networkState(){return this.networkStateController}getMediaElement(){if(!this.media)throw new v.i;return this.media}initMedia(e){this.media=e;var t=this.eventListeners.scope(this.media,"@_init");t.has("play")||this.played||t.once("play",(()=>{this.played=!0})),t.has("playing")||this.actuallyPlayed||t.once("playing",(()=>{this.actuallyPlayed=!0})),t.has("seeked")||this.seeked||t.once("seeked",(()=>{this.seeked=!0})),t.has("loadstart")||t.on("loadstart",(()=>{e.loading=!0;var i=()=>{t.off("loadeddata",i),t.off("emptied",i),t.off("error",i),delete e.loading};t.once("loadeddata",i),t.once("emptied",i),t.once("error",i),this.isLoaded()||this.isSourceChanging()||e.reloading||this.emit(this.Events.LoadStart)})),t.has("emptied")||t.on("emptied",(()=>{!this.isLoaded()||this.isSourceChanging()||e.reloading||this.detach().catch((e=>this.handleError(e,{severity:"warning",path:"detach"})))}))}attach(e,t,i){var n=this;return B((function*(){var s={stack:[],error:void 0,hasError:!1};try{(0,r.__addDisposableResource)(s,yield n.attachMutex.acquire("attach"),!1),n.media&&(yield n.detach());try{var a,o,l=null!=(a="function"==typeof(null==i?void 0:i.mediaWaitingDetection)?i.mediaWaitingDetection(n):null==i?void 0:i.mediaWaitingDetection)?a:{},h=null!=(o="function"==typeof(null==i?void 0:i.mediaStallDetection)?i.mediaStallDetection(n):null==i?void 0:i.mediaStallDetection)?o:"native"===n.playback;if(n.attachSources=t,n.attachOptions=P({},i,{mediaWaitingDetection:l,mediaStallDetection:h}),n.initMedia(e),n.waitingDetector=new R(n.eventListeners.scope(e,"@_WaitingDetector"),l).on("statechanged",(e=>{var{data:t}=e;n.emit(n.Events.WaitingStateChanged,t)})),h){var d=!0===h?void 0:h;n.stallDetector=new T(n.eventListeners.scope(e,"@_StallDetector"),d).on("statechanged",(e=>{var{data:t}=e;n.emit(n.Events.ProgressStateChanged,P({fatal:!1},t))}))}yield n.attachCore(e,n.attachSources,n.attachOptions)}catch(e){n.handleError(e,{path:"attach"})}}catch(e){s.error=e,s.hasError=!0}finally{(0,r.__disposeResources)(s)}}))()}detach(){var e=this;return B((function*(){var t={stack:[],error:void 0,hasError:!1};try{var i;(0,r.__addDisposableResource)(t,yield e.detachMutex.acquire("detach"),!1);var n=!!e.media;yield e.detachCore(),e.cleaners.forEach((e=>e())),(0,a.I)(e.cleaners),e.eventListeners.removeAllListeners(),e.waitingDetector&&(e.waitingDetector.destroy(),e.waitingDetector=void 0),e.stallDetector&&(e.stallDetector.destroy(),e.stallDetector=void 0),e.media&&((0,g.a)(e.media),e.media=void 0),e.attachSources=void 0,e.attachOptions=void 0,e.loaded=!1,e.live=!1,e.played=!1,e.actuallyPlayed=!1,e.seeked=!1,e.sourceChanging=!1,e.suspended=!1,null!=(i=e.liveChecker)&&i.stop(),e.liveChecker=void 0,n&&e.emit(e.Events.Detached)}catch(n){t.error=n,t.hasError=!0}finally{(0,r.__disposeResources)(t)}}))()}stopLoad(){}startLoad(){}isLoaded(){return this.loaded}isPlayed(){return this.played}isActuallyPlayed(){return this.actuallyPlayed}isSeeked(){return this.seeked}isWaiting(){var e;return!(null==(e=this.waitingDetector)||!e.isWaiting())}isStalled(){var e;return!(null==(e=this.stallDetector)||!e.isStalled())}isSourceChanging(){return this.sourceChanging}isPlaybackFreezed(){var e;return 0===(null==(e=this.media)?void 0:e.playbackRate)}isLive(){return this.live}isSuspended(){return this.suspended}suspend(){var e=this.getMediaElement();e.pause(),this.suspended=!0;var t=()=>this.releaseSuspended();this.eventListeners.scope(e,"@_suspend").removeAllListeners().once("play",t).once("ended",t).once("emptied",t)}releaseSuspended(){var e=this.getMediaElement();this.suspended=!1,this.eventListeners.removeAllListeners(e,"@_suspend")}seek(e){return(0,m.h)(this.getMediaElement(),e)}getCurrentTime(){var e,t;return null!=(e=null==(t=this.media)?void 0:t.currentTime)?e:0}getDuration(){return this.media?(0,u.A)(this.media)||(0,c.Q5)(this.media.seekable)||1/0:NaN}getSeekRange(){return this.media?{start:(0,c.BC)(this.media.seekable),end:(0,c.Q5)(this.media.seekable)}:{start:0,end:0}}setSourceChanging(e){this.sourceChanging!==e&&(this.sourceChanging=e,e?this.emit(this.Events.SourceChanging):this.emit(this.Events.SourceChanged))}setLive(e){var t,i=this.live;if(this.live=e,i&&!this.live&&null!=(t=this.attachOptions)&&null!=(t=t.liveRevivalCheck)&&t.url&&!this.liveChecker){var r=S(this.attachOptions.liveRevivalCheck,(()=>{r.stop(),this.media&&this.attachSources&&this.attach(this.media,this.attachSources,this.attachOptions).catch((e=>{this.handleError(e,{path:"liveChecker:attach"})}))}));this.liveChecker=r,this.liveChecker.start(),this.emit(this.Events.LiveStateChanged,this.getLiveState())}else!i&&this.live&&this.liveChecker&&(this.liveChecker.stop(),this.liveChecker=void 0,this.emit(this.Events.LiveStateChanged,this.getLiveState()))}getLiveLatency(){return 0}getLiveSeekLength(){if(!this.media||!this.live)return 0;var e=this.getSeekRange(),t=e.end-e.start;return t>0?t:0}getLiveEdgePosition(){if(!this.media||!this.live)return 0;var e=this.getSeekRange().end,t=this.getLiveLatency();return e>t?e-t:e}atLiveEdge(e,t){return void 0===e&&(e=this.getCurrentTime()),void 0===t&&(t=this.getLiveEdgePosition()),!(!this.live||!this.media||null==e)&&Math.ceil(e)>=Math.floor(t-4)}getLiveState(){var e=this.getLiveEdgePosition();return{live:this.isLive(),synced:this.atLiveEdge(this.getCurrentTime(),e),latency:this.getLiveLatency(),seekLength:this.getLiveSeekLength(),edgePosition:e}}getStateInfo(){var e=this.getDebugData();return P({name:this.name,format:this.format,playback:this.playback,loaded:this.isLoaded(),played:this.isPlayed(),actuallyPlayed:this.isActuallyPlayed(),seeked:this.isSeeked(),currentTime:this.getCurrentTime(),duration:this.getDuration(),waiting:this.isWaiting(),stalled:this.isStalled(),playbackFreezed:this.isPlaybackFreezed(),videoQuality:this.getVideoQuality(),audioTrack:this.getAudioTrack(),liveState:this.getLiveState()},e&&{debugData:e})}getDebugData(){}getStats(){var e,t,{droppedVideoFrames:i=0,totalVideoFrames:r=0}=null!=(e=null==(t=this.media)?void 0:t.getVideoPlaybackQuality())?e:{};return{videoQuality:this.getVideoQuality(),droppedVideoFrames:i,totalVideoFrames:r,estimatedBandwidth:0}}handleError(e,t){var i,r,n,s=e instanceof ErrorEvent&&e.error||e instanceof Event&&(null==(i=this.media)?void 0:i.error)||e,[a,h]=(null==t?void 0:t.type)&&[t.type,s]||s instanceof y.l&&["media",s]||s instanceof w._&&["drm",s]||s instanceof b.S&&["manifest",s]||s instanceof MediaError&&[p(s.code),(s.code===MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED||s.code===MediaError.MEDIA_ERR_DECODE)&&new y.l((0,l.u)(s),{cause:{code:s.code,codeName:(0,o.np)(MediaError,s.code)}})||s]||["generic",s];this.emit(this.Events.Error,P({},t,{severity:null!=(r=null==t?void 0:t.severity)?r:"fatal",path:null!=(n=null==t?void 0:t.path)?n:"handleError",type:a,error:h,state:this.getStateInfo()}))}destroy(){var e=this;return B((function*(){var t={stack:[],error:void 0,hasError:!1};try{(0,r.__addDisposableResource)(t,yield e.destroyMutex.acquire("destroy"),!1),yield e.detach(),yield e.destroyCore(),e.removeAllListeners()}catch(i){t.error=i,t.hasError=!0}finally{(0,r.__disposeResources)(t)}}))()}[Symbol.asyncDispose](){return this.destroy()}}(function(e){e.LoadStart="LoadStart",e.MetadataChanged="MetadataChanged",e.Loaded="Loaded",e.Detached="Detached",e.SourceWaiting="SourceWaiting",e.SourceChanging="SourceChanging",e.SourceChanged="SourceChanged",e.QualityChanged="QualityChanged",e.AudioTrackChanged="AudioTrackChanged",e.LiveStateChanged="LiveStateChanged",e.NetworkStateChanged="NetworkStateChanged",e.WaitingStateChanged="WaitingStateChanged",e.ProgressStateChanged="ProgressStateChanged",e.Error="Error"})((O=W||(W={})).Events||(O.Events={}))},39104:function(e,t,i){i.d(t,{N:function(){return n}});var r=i(31729);function n(e){var t="string"==typeof e?JSON.parse(e):e,i=t.payload?t.payload:t,{streams:n,audio_tracks:s}=i;return 0===n.length?{qualityLevels:{},audioTracks:{}}:{qualityLevels:n.reduce(((e,t)=>{var i=(0,r.j)(t);return null!=i&&(e[i]={id:t.idx,width:t.width,height:t.height,bandwidth:t.bandwidth,frameRate:t.frameRate,codecs:t.codecs,default:!!t.default}),e}),{}),audioTracks:s.reduce(((e,t)=>(e[t.lang]={id:t.idx,language:t.lang,name:t.name,default:!!t.default},e)),{})}}},41746:function(e,t,i){i.d(t,{u:function(){return n}});var r=i(80181);function n(e,t){return"string"==typeof e?r.c$.of(new URL(e,document.location.href)).map((e=>(t.forEach(((t,i)=>e.searchParams.set(i,t))),e.toString()))).getOrElse(e):Object.entries(e).reduce(((e,i)=>{var[r,s]=i;return e[r]="string"==typeof s?n(s,t):s,e}),{})}},45006:function(e,t,i){function r(e){(e.src||e.srcObject||e.childElementCount>0)&&(URL.revokeObjectURL(e.src),e.removeAttribute("src"),e.srcObject=null,e.childElementCount>0&&Array.prototype.filter.call(e.children,(e=>e instanceof HTMLSourceElement)).forEach((t=>e.removeChild(t))),e.load())}i.d(t,{a:function(){return r}})},55277:function(e,t,i){i.r(t),i.d(t,{default:function(){return I}});var r=i(54548),n=i(69805),s=i(64917),a=i(44022),o=i(35185),l=i(82128),h=i(9624),d=i(41746),u=i(77687),c=i(15779),g=i(88913),v=i(38105),f=i(52178),m=i(58245),p=i(70866),y=i(27098);function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},w.apply(null,arguments)}class b extends m.b{constructor(e){var t,i=(0,y.i)();if(!i)throw new Error("MediaSource is not supported.");super(),this.queue=[],this.isQueueEmpty=!0,this.offset=0,this.nextDuration=0,this.initBuffer=()=>{if(!this.sourceBuffer){this.ms.duration=1/0;var e=this.ms.addSourceBuffer(this.options.mimeType+'; codecs="'+this.options.codecs+'"');e.mode="segments",e.onupdateend=()=>{this.updateCallback&&(this.updateCallback(),this.updateCallback=void 0),this.isOpen()&&(this.nextDuration>this.ms.duration||this.ms.duration===1/0&&this.nextDuration!==this.ms.duration)&&(this.ms.duration=this.nextDuration),this.emit("updateended"),this.readFromQueue()},e.timestampOffset=this.offset,e.appendWindowStart=this.offset,this.sourceBuffer=e,this.emit("buffercreated")}},this.readFromQueue=()=>{if(this.sourceBuffer&&!this.sourceBuffer.updating){var e=this.queue.shift();e?this.appendBuffer(e):this.isQueueEmpty=!0}},this.close=()=>{if(this.sourceBuffer){try{if(this.sourceBuffer){if(this.sourceBuffer.onupdateend=null,this.ms.sourceBuffers.length>0)try{this.ms.removeSourceBuffer(this.sourceBuffer)}catch(e){this.options.logger.error(e)}this.sourceBuffer=void 0}this.updateCallback=void 0,this.isQueueEmpty=!0,this.offset=0,this.nextDuration=0,(0,p.I)(this.queue)}catch(e){this.options.logger.error(e)}this.emit("closed")}},this.options=w({},e,{logger:null!=(t=e.logger)?t:console}),this.ms=new i,this.ms.addEventListener("sourceopen",this.initBuffer),this.ms.addEventListener("sourceclose",this.close)}isOpen(){return"open"===this.ms.readyState}setDuration(e){try{var t;if(!this.isOpen()||this.ms.duration===e)return void(this.nextDuration=e);if(Number.isFinite(e)&&Number.isFinite(this.ms.duration)&&e<this.ms.duration)return void this.options.logger.warn("Next duration ("+e+") is lower than current ("+this.ms.duration+").");null!=(t=this.sourceBuffer)&&t.updating?this.nextDuration=e:this.ms.duration=e}catch(e){this.options.logger.error(e)}}configure(e,t){this.offset=e,this.setDuration(t)}appendBuffer(e){if(this.isOpen()&&this.sourceBuffer)try{this.sourceBuffer.appendBuffer(e)}catch(e){this.options.logger.error(e)}}push(e){if(this.sourceBuffer)return this.isQueueEmpty?(this.appendBuffer(e),void(this.isQueueEmpty=!1)):void this.queue.push(e)}setCodecs(e){this.sourceBuffer&&this.sourceBuffer.changeType(this.options.mimeType+'; codecs="'+e+'"')}updateBufferAppendWindow(){if(this.sourceBuffer&&0!==this.sourceBuffer.buffered.length&&!this.sourceBuffer.updating){var e=(0,l.Q5)(this.sourceBuffer.buffered);try{this.sourceBuffer.appendWindowStart=e,this.sourceBuffer.timestampOffset=e}catch(e){this.options.logger.error(e)}}}destroy(){this.close(),this.ms.removeEventListener("sourceopen",this.initBuffer),this.ms.removeEventListener("sourceclose",this.close),this.removeAllListeners()}[Symbol.dispose](){return this.destroy()}}var E=i(39104),C=i(3553),S=i(30732),_=i(55510),k=i.n(_),L=i(2593);class T{constructor(e){if(e<=0)throw new Error("Expected halfLife to be positive");this.alpha=Math.exp(Math.log(.5)/e),this.estimate=0,this.totalWeight=0}updateAlpha(e){if(e<=0)throw new Error("Expected halfLife to be positive");this.alpha=Math.exp(Math.log(.5)/e)}sample(e,t){var i=Math.pow(this.alpha,e),r=t*(1-i)+i*this.estimate;Number.isNaN(r)||(this.estimate=r,this.totalWeight+=e)}getEstimate(){var e=1-Math.pow(this.alpha,this.totalWeight);return this.estimate/e}}class O{constructor(){this.fast=new T(2),this.slow=new T(5),this.bytesSampled=0,this.minTotalBytes=128e3,this.minBytes=16e3}configure(e){this.minTotalBytes=e.minTotalBytes,this.minBytes=e.minBytes,this.fast.updateAlpha(e.fastHalfLife),this.slow.updateAlpha(e.slowHalfLife)}sample(e,t){if(!(t<this.minBytes)){var i=8e3*t/e,r=e/1e3;this.bytesSampled+=t,this.fast.sample(r,i),this.slow.sample(r,i)}}getBandwidthEstimate(e){return this.bytesSampled<this.minTotalBytes?e:Math.min(this.fast.getEstimate(),this.slow.getEstimate())}hasGoodEstimate(){return this.bytesSampled>=this.minTotalBytes}}var D=(e,t,i)=>e>=t&&e<=i;function M(e,t,i,r){var n;return n=e?t.filter((t=>{if(!e)throw new Error("Restrictions should exist!");return function(e,t,i){var r={width:e.width,height:e.height,frameRate:e.frameRate};if(r&&r.width&&r.height){if(!D(r.width,t.minWidth,Math.min(t.maxWidth,i.width)))return!1;if(!D(r.height,t.minHeight,Math.min(t.maxHeight,i.height)))return!1;if(!D(r.width*r.height,t.minPixels,t.maxPixels))return!1}return!(r&&r.frameRate&&!D(r.frameRate,t.minFrameRate,t.maxFrameRate)||!D(e.bandwidth,t.minBandwidth,t.maxBandwidth))}(t,e,{width:r,height:i})})):[...t],n.sort(((e,t)=>e.bandwidth-t.bandwidth))}class R{constructor(e,t){this.config=e,this.logger=t,this.bandwidthEstimator=new O,this.switchCallback=null,this.enabled=!1,this.variants=[],this.playbackRate=1,this.startupComplete=!1,this.lastTimeChosenMs=null,this.mediaElement=null,this.resizeObserver=null,this.onNetworkInformationChange=null,navigator.connection&&navigator.connection.addEventListener&&(this.onNetworkInformationChange=()=>{if(this.config.useNetworkInformation&&this.enabled){this.bandwidthEstimator=new O,this.config&&this.bandwidthEstimator.configure(this.config.advanced);var e=this.chooseVariant();e&&this.switchCallback&&this.switchCallback(e)}},navigator.connection.addEventListener("change",this.onNetworkInformationChange)),this.resizeObserverTimer=(0,n.N)((()=>{if(this.config.restrictToElementSize){var e=this.chooseVariant();e&&this.switchCallback&&this.switchCallback(e)}}),1e3*R.RESIZE_OBSERVER_BATCH_TIME),this.configure(this.config)}stop(){var e;this.switchCallback=null,this.enabled=!1,this.variants=[],this.playbackRate=1,this.lastTimeChosenMs=null,this.mediaElement=null,this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),null==(e=this.resizeObserverTimer)||e.cancel()}release(){navigator.connection&&navigator.connection.removeEventListener&&(navigator.connection.removeEventListener("change",this.onNetworkInformationChange),this.onNetworkInformationChange=null),this.resizeObserverTimer=null}init(e){this.switchCallback=e}chooseVariant(){var e=1/0,t=1/0;if(this.config.restrictToScreenSize){var i=this.config.ignoreDevicePixelRatio?1:window.devicePixelRatio;e=window.screen.height*i,t=window.screen.width*i}if(this.resizeObserver&&this.config.restrictToElementSize&&this.mediaElement){var r=this.config.ignoreDevicePixelRatio?1:window.devicePixelRatio;e=this.mediaElement.clientWidth*r,t=this.mediaElement.clientHeight*r}var n=M(this.config.restrictions,this.variants,e,t),s=this.getDefaultBandwidth(),a=this.bandwidthEstimator.getBandwidthEstimate(s);this.variants.length&&!n.length&&(this.logger.warn("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),n=[(n=M(null,this.variants,1/0,1/0))[0]]);for(var o=n[0]||null,l=0;l<n.length;l+=1){for(var h=n[l],d=Number.isNaN(this.playbackRate)?1:Math.abs(this.playbackRate),u=d*h.bandwidth,c=u/this.config.bandwidthDowngradeTarget,g={bandwidth:1/0},v=l+1;v<n.length;v+=1)if(h.bandwidth!==n[v].bandwidth){g=n[v];break}var f=d*g.bandwidth/this.config.bandwidthUpgradeTarget;this.logger.debug("Bandwidth ranges:",(u/1e6).toFixed(3),(c/1e6).toFixed(3),(f/1e6).toFixed(3)),a>=c&&a<=f&&o.bandwidth!==h.bandwidth&&(o=h)}return this.lastTimeChosenMs=Date.now(),o}enable(){this.enabled=!0}disable(){this.enabled=!1}segmentDownloaded(e,t){if(this.logger.debug("Segment downloaded:","deltaTimeMs="+e,"numBytes="+t,"lastTimeChosenMs="+String(this.lastTimeChosenMs),"enabled="+String(this.enabled)),e<0)throw new Error("expected a non-negative duration");this.bandwidthEstimator.sample(e,t),null!=this.lastTimeChosenMs&&this.enabled&&this.suggestStreams()}getBandwidthEstimate(){var e=this.getDefaultBandwidth();return this.bandwidthEstimator.getBandwidthEstimate(e)}setVariants(e){this.variants=e}playbackRateChanged(e){this.playbackRate=e}setMediaElement(e){this.mediaElement=e,this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.mediaElement&&"ResizeObserver"in window&&(this.resizeObserver=new ResizeObserver((()=>{var e;null==(e=this.resizeObserverTimer)||e.delay(1e3*R.RESIZE_OBSERVER_BATCH_TIME)})),this.resizeObserver.observe(this.mediaElement))}configure(e){this.config=e,this.bandwidthEstimator&&this.config&&this.bandwidthEstimator.configure(this.config.advanced)}suggestStreams(){if(this.logger.debug("Suggesting Streams..."),null==this.lastTimeChosenMs)throw new Error("lastTimeChosenMs_ should not be null");if(this.startupComplete){if(Date.now()-this.lastTimeChosenMs<1e3*this.config.switchInterval)return void this.logger.debug("Still within switch interval...")}else{if(!this.bandwidthEstimator.hasGoodEstimate())return void this.logger.debug("Still waiting for a good estimate...");this.startupComplete=!0}var e=this.chooseVariant(),t=this.getDefaultBandwidth(),i=this.bandwidthEstimator.getBandwidthEstimate(t),r=Math.round(i/1e3);e&&this.switchCallback&&(this.logger.debug("Calling switch_(), bandwidth="+r+" kbps"),this.switchCallback(e))}getDefaultBandwidth(){var{defaultBandwidthEstimate:e}=this.config;return navigator.connection&&navigator.connection.downlink&&this.config.useNetworkInformation&&(e=1e6*navigator.connection.downlink),e}}function P(){return P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},P.apply(null,arguments)}R.RESIZE_OBSERVER_BATCH_TIME=1;class x extends m.b{constructor(e){var t,i,r;super(),this.networkStatsCounter=function(){var e=0,t={timeDelta:0,bytes:0};return{progress(i){var r=Date.now();return e>0&&(t={timeDelta:r-e,bytes:i}),e=r,t},getLastStats:()=>t,reset(){e=0,t={timeDelta:0,bytes:0}}}}(),this.options=P({},e,{config:k()({enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.5,bandwidthDowngradeTarget:.8,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:null!=(r=navigator.connection)&&r.saveData?360:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0,minChannelsCount:0,maxChannelsCount:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1,clearBufferSwitch:!1,safeMarginSwitch:0,cacheLoadThreshold:20,minTimeToSwitch:0,preferNetworkInformationBandwidth:!1},null!=(t=e.config)?t:{}),logger:null!=(i=e.logger)?i:(0,L.t)("AbrController")}),this.abrManager=new R(this.options.config,this.options.logger),this.init()}init(){this.abrManager.init((e=>{this.emit("switch",e)})),this.abrManager.setMediaElement(this.options.media)}stop(){this.abrManager.stop(),this.networkStatsCounter.reset()}load(e){var t=Object.entries(e).filter((e=>"auto"!==e[0])).map((e=>{var t,i,[r,n]=e;return{width:n.width,height:n.height,bandwidth:null!=(t=n.bandwidth)?t:+r*(null!=(i=n.frameRate)?i:25)*146,frameRate:n.frameRate,q:+r}}));this.abrManager.setVariants(t)}enable(){this.networkStatsCounter.reset(),this.abrManager.enable()}disable(){this.networkStatsCounter.reset(),this.abrManager.disable()}chooseVariant(){return this.abrManager.chooseVariant()}setPlaybackRate(e){e<=0||this.abrManager.playbackRateChanged(e)}progress(e){var t=this.networkStatsCounter.progress(e);0===t.timeDelta&&0===t.bytes||this.abrManager.segmentDownloaded(t.timeDelta,t.bytes)}destroy(){this.stop(),this.abrManager.release()}[Symbol.dispose](){return this.destroy()}}var B=["drm","abr","dvr"];function W(){return W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},W.apply(null,arguments)}function Q(e,t,i,r,n,s,a){try{var o=e[s](a),l=o.value}catch(e){return void i(e)}o.done?t(l):Promise.resolve(l).then(r,n)}function N(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var s=e.apply(t,i);function a(e){Q(s,r,n,a,o,"next",e)}function o(e){Q(s,r,n,a,o,"throw",e)}a(void 0)}))}}class I extends v.n{constructor(e){void 0===e&&(e=void 0),super("ws","WSDriver",e),this.playback="driver",this.currentDriver=!0,this.sendState=(()=>{var e=e=>{if(this.sendState.invoked=!1,this.sendState.delayed.cancel(),this.wsController){var t=this.getState(e);t?this.wsController.send(JSON.stringify({method:"user_state",payload:t})):this.emitStateError("sendState")}};return e.delayed=(0,r.G)((0,n.N)(e,3e3),(()=>{this.sendState.invoked=!0})),e.invoked=!1,e})()}getState(e){var t,i;if(this.wsController&&this.media){var r=null!=this.actualQuality?null==(t=this.qualityLevels)||null==(t=t[this.actualQuality])?void 0:t.id:void 0,n=null!=this.currentAudio?null==(i=this.audioTracks)||null==(i=i[this.currentAudio])?void 0:i.id:void 0;return{paused:null!=e?e:this.media.paused,video_track_id:r,audio_track_id:n}}}emitStateError(e){this.handleError(new Error("The current state (user_state) is undefined."),{severity:"warning",path:e})}seek(e){var t=()=>super.atLiveEdge,i=()=>super.seek,r=this;return N((function*(){var n,s,{attachSources:a,seekVideoController:o}=r;return a&&r.isPlayed()&&o&&(r.currentDriver||t().call(r,e))?r.isSourceChanging()?r.getMediaElement().currentTime:S.j(r,{isIdleMode:()=>r.currentDriver,onStart:()=>r.setSourceChanging(!0),onEnd:()=>r.setSourceChanging(!1),onError:(e,t)=>r.handleError(e,{severity:t,path:"dvrSeeking"}),onDvrSeek:(s=N((function*(t){var i,n;r.currentDriver=!1,null!=(i=r.abrController)&&i.stop(),yield o.reattach(t,{quality:r.currentQuality,initialTime:e,driverSettings:null==(n=r.attachOptions)||null==(n=n.settings)||null==(n=n.dvr)?void 0:n.driverSettings})})),function(e){return s.apply(this,arguments)}),onNormalSeek:(n=N((function*(e){var t;r.currentDriver=!0,yield o.detach().catch((e=>r.handleError(e,{severity:"warning",path:"dvrSeeking"}))),yield r.attachCore(e,a,W({},r.attachOptions,{quality:r.currentQuality,audioTrack:r.currentAudio})),null==(t=r.abrController)||t.init()})),function(e){return n.apply(this,arguments)})}):i().call(r,e)}))()}connect(e,t,i){var r=()=>super.seek,n=this;return N((function*(){var h,d=n.getMediaElement(),u=(0,o.e)(i.ms,"waitsrc"),c=(0,a.s)();if(t.connect(),null!=(h=e.dvr)&&h.sources&&!(0,s.R)(e.dvr.sources)){var g;if(!n.seekVideoController){var v=new C.I(n,{logger:n.logger}).on(f.I.Events.DurationChange,(e=>{var{data:t}=e;n.isPlayed()&&i.setDuration(t.duration)})).on(f.I.Events.QualityChanged,(e=>{var{data:t}=e;n.currentDriver||n.emit(n.Events.QualityChanged,t)}));n.seekVideoController=v}n.seekVideoController.attach(n.seekVideoController.idleMedia,W({},e.dvr,{live:{setInitialTime:!0},driverSettings:null==(g=n.attachOptions)||null==(g=g.settings)||null==(g=g.dvr)?void 0:g.driverSettings})).catch((e=>n.handleError(e,{severity:"warning",path:"connect"}))).finally((()=>c.resolve()))}else c.resolve();if(yield u.wait(),yield c.wait(),n.seekVideoController&&n.seekVideoController.isAttached()){var m=n.seekVideoController.getLiveState();i.configure(m.edgePosition,n.seekVideoController.getDuration())}var p=(0,a.s)();n.eventListeners.scope(d,"connect").removeAllListeners().on("progress",(()=>{d.buffered.length>0&&p.resolve()})),n.getMediaElement().src=URL.createObjectURL(i.ms),n.sendState(!1),yield p.wait(),n.eventListeners.scope(d,"connect").removeAllListeners();var y=(0,l.BC)(d.buffered);d.currentTime<y&&(yield r().call(n,y))}))()}attachCore(e,t,i){var r=this;return N((function*(){try{var n,s,a,o=null!=(n=i.settings)?n:{},{drm:v,abr:f=!0}=o,m=function(e,t){if(null==e)return{};var i={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;i[r]=e[r]}return i}(o,B),{quality:p,audioTrack:y,sourceParams:w}=i,C=w?(0,d.u)(t.src,w):t.src,S=null!=v&&v.auth?W({},t,{src:(yield v.auth(C))||C}):W({},t,{src:C});if(r.wsController&&r.msWriter)return void(yield r.connect(S,r.wsController,r.msWriter));r.setLive(!0);var _=r.eventListeners.scope(e,"attachcore").removeAllListeners().on("error",(e=>r.handleError(e))).on("play",(()=>{var e;r.currentDriver&&(r.sendState(),"auto"===r.currentQuality&&(null==(e=r.abrController)||e.enable()))})).on("pause",(()=>{var e;r.currentDriver&&(r.sendState.delayed(),null==(e=r.abrController)||e.disable())})).once("loadedmetadata",(()=>{var{qualityLevels:t={},audioTracks:i={}}=r;r.emit(r.Events.MetadataChanged,{qualityLevels:t,audioTracks:i,masterSource:S.src}),_.on("canplay",(()=>{!e.paused||r.sendState.delayed.isPending||r.sendState.invoked||r.sendState.delayed()})).once("canplay",(()=>{null!=r.currentQuality&&r.qualityLevels&&(r.emit(r.Events.Loaded,{quality:r.currentQuality,qualityLevels:t,audioTracks:i,audioTrack:r.currentAudio,masterSource:S.src,liveState:r.getLiveState(),drm:!1}),"auto"===r.currentQuality&&null!=r.actualQuality&&r.emit(r.Events.QualityChanged,{quality:r.actualQuality,auto:!0}))}))})),k=new b({mimeType:"video/mp4",codecs:"mp4a.40.2,avc1.4D401F",logger:r.logger}).on("closed",(()=>{r.sendState.delayed.cancel(),T.close()})).on("buffercreated",(e=>{var t,{target:i}=e,n=r.actualQuality&&(null==(t=r.qualityLevels)||null==(t=t[r.actualQuality])?void 0:t.codecs);n&&i.setCodecs(n)}));r.msWriter=k;var L=()=>{k.ms.dispatchEvent(new Event("waitsrc"))},T=new h.B(S.src,W({startClosed:!0,binaryType:"arraybuffer",logger:r.logger},m,{maxRetries:null!=(s=m.maxRetries)?s:3,idleTimeout:null!=(a=m.idleTimeout)?a:3e4})).on(h.B.Events.Closed,(e=>{var{data:t}=e;(null==t?void 0:t.reason)&&r.handleError(new Error(t.reason||"WS connection closed unexpectedly."),{type:"network",path:"ws:"+S.src})})).on(h.B.Events.Message,(t=>{var{data:{data:i}}=t;try{var n;if("string"==typeof i){var s=JSON.parse(i);if("meta_response"===s.method){var a;if(r.qualityLevels)return void(e.src?(r.sendState(r.isLoaded()&&void 0),k.updateBufferAppendWindow()):L());try{var{qualityLevels:o,audioTracks:l}=(0,E.N)(s.payload);r.qualityLevels=r.abrController?W({auto:{id:"@@auto",width:0,height:0,codecs:"",default:!1}},o):o,r.audioTracks=l}catch(e){return void r.handleError(e,{path:"ws:parseManifest:"+S.src})}r.abrController&&r.abrController.load(r.qualityLevels);var h="function"==typeof p?p(r.qualityLevels):p,[d,,g]=(0,u.t)(r.qualityLevels,h,!0,null==(a=r.abrController)?void 0:a.chooseVariant().q),v="function"==typeof y?y(r.audioTracks):y,f=!1===v?void 0:(0,c.j)(r.audioTracks,v,{tryDefault:!0,tryFirst:!0});r.currentQuality=g?"auto":d,r.actualQuality=d,r.currentAudio=null==f?void 0:f.language,L()}}else null!=(n=r.abrController)&&n.progress(i.byteLength),k.push(i)}catch(e){r.handleError(e,{severity:"warning",path:"ws:message:"+S.src})}}));r.wsController=T,f&&(r.abrController=new x({media:e,logger:r.logger}).on("switch",(t=>{var{data:i}=t;r.logger.isLevelEnabled("info")&&r.logger.info("AbrController switch to "+i.q+",","current: "+String(r.currentQuality)+", actual: "+String(r.actualQuality)+".",e.currentTime+"/"+(0,l.Q5)(e.buffered)),"auto"===r.currentQuality&&r.setVideoQuality(i.q,!0)}))),yield r.connect(S,r.wsController,r.msWriter)}catch(e){throw new g.X(t.src,{cause:e})}}))()}detachCore(){var e=this;return N((function*(){e.wsController&&(e.wsController.destroy(),e.wsController=void 0),e.msWriter&&(e.msWriter.isOpen()&&e.msWriter.ms.endOfStream(),e.msWriter.destroy(),e.msWriter=void 0),e.seekVideoController&&(yield e.seekVideoController.detach(),e.seekVideoController.removeAllListeners(),e.seekVideoController=void 0),e.abrController&&(e.abrController.destroy(),e.abrController=void 0),e.qualityLevels=void 0,e.audioTracks=void 0,e.currentQuality=void 0,e.actualQuality=void 0,e.currentAudio=void 0,e.currentDriver=!0}))()}getLiveLatency(){var e;return null!=(e=this.seekVideoController)&&e.isLoaded()?this.seekVideoController.getLiveState().latency:super.getLiveLatency()}getLiveSeekLength(){var e;return null!=(e=this.seekVideoController)&&e.isLoaded()?this.seekVideoController.getLiveState().seekLength:0}getLiveEdgePosition(){var e;return this.media?this.isPlayed()&&null!=(e=this.seekVideoController)&&e.isLoaded()?this.seekVideoController.getLiveState().edgePosition:(0,l.Q5)(this.media.buffered):super.getLiveEdgePosition()}atLiveEdge(){return this.currentDriver}getVideoQuality(){return this.currentQuality}isValidVideoQuality(e){var t;return null!=(null==(t=this.qualityLevels)||null==(t=t[e])?void 0:t.id)}setVideoQuality(e,t){var i,r,n;if(void 0===t&&(t=!1),e!==this.currentQuality&&(!t||e!==this.actualQuality)){var{wsController:s,qualityLevels:a}=this;if(s&&a&&this.isValidVideoQuality(e)&&!this.isSourceChanging()&&null!=a[e]){var o=this.actualQuality;t||(this.currentQuality=e),"auto"!==e&&(this.actualQuality=e),this.currentDriver?(!t&&this.abrController&&("auto"!==e||null!=(i=this.media)&&i.paused?this.abrController.disable():(this.abrController.enable(),this.actualQuality=this.abrController.chooseVariant().q)),this.actualQuality!==o&&(this.sendState(),null!=(r=this.msWriter)&&r.updateBufferAppendWindow()),this.emit(this.Events.QualityChanged,{quality:e,auto:t}),null!=this.actualQuality&&this.actualQuality!==o&&this.emit(this.Events.QualityChanged,{quality:this.actualQuality,auto:!0})):null==(n=this.seekVideoController)||n.setVideoQuality(e)}}}getAudioTrack(){return this.currentAudio}isValidAudioTrack(e){var t;return null!=(null==(t=this.audioTracks)||null==(t=t[e])?void 0:t.id)}setAudioTrack(e){var t,i,r;if(e!==this.currentAudio){var{wsController:n,audioTracks:s}=this;if(n&&s&&this.isValidAudioTrack(e))null!=(null==(t=s[e])?void 0:t.id)&&(this.currentAudio=e,this.currentDriver?(this.sendState(),null==(i=this.msWriter)||i.updateBufferAppendWindow()):null==(r=this.seekVideoController)||r.setAudioTrack(e),this.emit(this.Events.AudioTrackChanged,{lang:e}))}}setMaxQuality(){}setMaxAbrQuality(){}destroyCore(){}}},88913:function(e,t,i){i.d(t,{X:function(){return s}});var r=i(16683);function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},n.apply(null,arguments)}class s extends r.D{constructor(e,t){void 0===t&&(t=void 0),super(s,"Error during loading source: "+e+".",n({},t,{name:"LoadError"}))}}}}]);